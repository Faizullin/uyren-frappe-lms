import"@headlessui/vue";import{au as B,s as N,i as S,r as L,z as U,o as z,b as y,c as D,w as T,u as A,d as I,e as u,f as l,g as _,h as r,l as e,j as f,k as g,t as b,af as E,q as H,n,ag as K,F as v,x as P,ah as O,ab as G,aj as J,ak as Q,al as W,B as X,p as V,av as Y,am as Z,_ as w,an as ee,ao as se,H as ae}from"./index-BIerRe8o.js";import{_ as te}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Cdx-1Hlv.js";import"@tiptap/extension-code-block-lowlight";import"@tiptap/extension-placeholder";import"@tiptap/extension-table";import"@tiptap/extension-table-cell";import"@tiptap/extension-table-header";import"@tiptap/extension-table-row";import"@tiptap/extension-text-align";import"@tiptap/extension-text-style";import"@tiptap/extension-typography";import"@tiptap/vue-3";import"@tiptap/extension-mention";import{_ as re}from"./EmptyState.vue_vue_type_script_setup_true_lang-CbCenUow.js";import"@vueuse/core";import"@tiptap/core";import"@tiptap/extension-code-block";import"@tiptap/extension-heading";import"@tiptap/suggestion";import"@tiptap/extension-link";const ie={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},oe={class:"p-6"},le={class:"flex items-center justify-between space-x-32 mb-5"},ne={class:"text-xl font-semibold text-ink-gray-7"},me={key:0,class:"grid grid-cols-3 gap-5 flex-1"},ue={key:0},ce={key:0},de={key:1},_e={class:"flex gap-2"},pe={key:2,class:"flex justify-center my-5"},Le=B({__name:"ProgrammingExerciseSubmissions",setup(fe){const{brand:F}=N(),j=S("$dayjs"),p=S("$user"),h=["exercise","member","status"],o=L({exercise:"",member:"",status:""}),c=U();z(()=>{C(),M()});const C=()=>{h.forEach(s=>{c.currentRoute.value.query[s]&&(o.value[s]=c.currentRoute.value.query[s])})},M=()=>{k.value?o.value.member=p.data?.name:i.reload()},i=D({doctype:"LMS Programming Exercise Submission",fields:["name","exercise","exercise_title","member_name","member_image","status","modified"],orderBy:"modified desc",transform(s){return s.map(a=>({...a,modified:j(a.modified).fromNow()}))}});T(o.value,()=>{let s={};h.forEach(a=>{if(o.value[a])s[a]=o.value[a],c.push({query:{...c.currentRoute.value.query,[a]:o.value[a]}});else{delete s[a];const d={...c.currentRoute.value.query};delete d[a],c.push({query:d})}}),i.update({filters:{...s}}),i.reload()});const R=(s,a)=>{Array.from(s).forEach(async d=>{await i.delete.submit(d)}),a(),ae.success(__("Submissions deleted successfully"))},k=y(()=>!p.data?.is_instructor&&!p.data?.is_moderator&&!p.data?.is_evaluator),x=y(()=>[{label:__("Member"),key:"member_name",width:"20%",icon:"user"},{label:__("Exercise"),key:"exercise_title",width:"30%",icon:"code"},{label:__("Status"),key:"status",width:"20%",icon:"check-circle"},{label:__("Modified"),key:"modified",width:"20%",icon:"clock",align:"right"}]),q=y(()=>[{label:__("Programming Exercise Submissions"),route:{name:"ProgrammingExerciseSubmissions"}}]);return A(()=>({title:__("Programming Exercises"),icon:F.favicon})),(s,a)=>{const d=I("router-link");return l(),u(v,null,[_("header",ie,[r(e(te),{items:q.value},null,8,["items"])]),_("div",oe,[_("div",le,[_("div",ne,b(e(i).data?.length?s.__("{0} Submissions").format(e(i).data.length):s.__("No Submissions")),1),e(i).data?.length?(l(),u("div",me,[r(E,{doctype:"LMS Programming Exercise",modelValue:o.value.exercise,"onUpdate:modelValue":a[0]||(a[0]=t=>o.value.exercise=t),placeholder:s.__("Filter by Exercise")},null,8,["modelValue","placeholder"]),r(E,{doctype:"User",modelValue:o.value.member,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.member=t),placeholder:s.__("Filter by Member"),readonly:k.value},null,8,["modelValue","placeholder","readonly"]),r(e(H),{modelValue:o.value.status,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value.status=t),type:"select",options:[{label:s.__(""),value:""},{label:s.__("Passed"),value:"Passed"},{label:s.__("Failed"),value:"Failed"}],placeholder:s.__("Filter by Status")},null,8,["modelValue","options","placeholder"])])):g("",!0)]),e(i).loading||e(i).data?.length?(l(),f(e(se),{key:0,columns:x.value,rows:e(i).data,rowKey:"name",options:{selectable:!0}},{default:n(()=>[r(e(K),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:n(()=>[(l(!0),u(v,null,P(x.value,t=>(l(),f(e(O),{item:t,key:t.key},{prefix:n(({item:m})=>[r(e(G),{name:m.icon?.toString(),class:"h-4 w-4"},null,8,["name"])]),_:2},1032,["item"]))),128))]),_:1}),r(e(J),null,{default:n(()=>[(l(!0),u(v,null,P(e(i).data,t=>(l(),f(d,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:t.exercise,submissionID:t.name}}},{default:n(()=>[r(e(Q),{row:t},{default:n(({column:m,item:$})=>[r(e(W),{item:t[m.key],align:m.align},{prefix:n(()=>[m.key=="member_name"?(l(),u("div",ue,[r(e(Y),{class:"flex items-center",image:t.member_image,label:$,size:"sm"},null,8,["image","label"])])):g("",!0)]),default:n(()=>[m.key=="status"?(l(),u("div",ce,[r(e(X),{theme:t[m.key]==="Passed"?"green":"red"},{default:n(()=>[V(b(t[m.key]),1)]),_:2},1032,["theme"])])):(l(),u("div",de,b(t[m.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),r(e(Z),null,{actions:n(({unselectAll:t,selections:m})=>[_("div",_e,[r(e(w),{variant:"ghost",onClick:$=>R(m,t)},{default:n(()=>[r(e(ee),{class:"h-4 w-4 stroke-1.5"})]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(l(),f(re,{key:1,type:"Programming Exercise Submissions"})),e(i).data&&e(i).hasNextPage?(l(),u("div",pe,[r(e(w),{onClick:a[3]||(a[3]=t=>e(i).next())},{default:n(()=>[V(b(s.__("Load More")),1)]),_:1})])):g("",!0)])],64)}}});export{Le as default};
