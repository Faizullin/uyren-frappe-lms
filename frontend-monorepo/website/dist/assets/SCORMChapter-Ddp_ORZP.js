import"@headlessui/vue";import{s as M,T as N,i as w,r as E,a4 as G,a5 as $,c as x,A as y,b as T,u as P,e as i,f as u,g as n,k as V,h as _,l as o,t as S,n as D,p as R,_ as I,F as k,a as A}from"./index-BIerRe8o.js";import{_ as B}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Cdx-1Hlv.js";import"@tiptap/extension-code-block-lowlight";import"@tiptap/extension-placeholder";import"@tiptap/extension-table";import"@tiptap/extension-table-cell";import"@tiptap/extension-table-header";import"@tiptap/extension-table-row";import"@tiptap/extension-text-align";import"@tiptap/extension-text-style";import"@tiptap/extension-typography";import"@tiptap/vue-3";import"@tiptap/extension-mention";import"@vueuse/core";import"@tiptap/core";import"@tiptap/extension-code-block";import"@tiptap/extension-heading";import"@tiptap/suggestion";import"@tiptap/extension-link";const F={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},z={key:0},j=["src"],q={key:1},O={class:"text-center pt-10 px-5 md:px-0 pb-10"},Y={class:"text-center"},H={class:"mb-4"},_e={__name:"SCORMChapter",props:{courseName:{type:String,required:!0},chapterName:{type:String,required:!0}},setup(h){const{brand:f}=M(),g=N(),a=w("$user"),l=E(!1),r=h;G(()=>{g.isSidebarCollapsed=!0,C()});const s=$({doctype:"Course Chapter",name:r.chapterName,auto:!0,cache:["chapter",r.chapterName],onSuccess(e){p.submit()}}),c=x({doctype:"LMS Enrollment",fields:["member","course"],filters:{course:r.courseName,member:a.data?.name},auto:!0,cache:["enrollments",r.courseName,a.data?.name]}),m=e=>e=="cmi.core.lesson_status"?p.data?.status=="Complete"?"passed":"incomplete":"",d=(e,t)=>{e=="cmi.core.lesson_status"&&t=="passed"&&b()},b=()=>{A("lms.lms.doctype.course_lesson.course_lesson.save_progress",{lesson:s.doc.lessons[0].lesson,course:r.courseName})},p=y({url:"frappe.client.get_value",makeParams(e){return{doctype:"LMS Course Progress",fieldname:"status",filters:{member:a.data?.name,lesson:s.doc.lessons[0].lesson,chapter:s.doc.name,course:s.doc?.course}}},onSuccess(e){l.value=!0}}),v=()=>{c.insert.submit({course:r.courseName,member:a.data?.name},{onSuccess(e){window.location.reload()}})},C=()=>{window.API_1484_11={Initialize:()=>"true",Terminate:()=>"true",GetValue:e=>(console.log(`GET: ${e}`),m(e)),SetValue:(e,t)=>(console.log(`SET: ${e} to value: ${t}`),d(e,t),"true"),Commit:()=>"true",GetLastError:()=>"0",GetErrorString:()=>"",GetDiagnostic:()=>""},window.API={LMSInitialize:()=>"true",LMSFinish:()=>"true",LMSGetValue:e=>(console.log(`GET: ${e}`),m(e)),LMSSetValue:(e,t)=>(console.log(`SET: ${e} to value: ${t}`),d(e,t),"true"),LMSCommit:()=>"true",LMSGetLastError:()=>"0",LMSGetErrorString:()=>"",LMSGetDiagnostic:()=>""}},L=T(()=>[{label:"Courses",route:{name:"Courses"}},{label:s.doc?.course_title,route:{name:"CourseDetail",params:{courseName:r.courseName}}},{label:s.doc?.title}]);return P(()=>({title:s.doc?.title,icon:f.favicon})),(e,t)=>(u(),i(k,null,[n("header",F,[_(o(B),{class:"h-7",items:L.value},null,8,["items"])]),l.value&&(o(c).data?.length||o(a).data?.is_moderator||o(a).data?.is_instructor)?(u(),i("div",z,[n("iframe",{src:o(s).doc.launch_file,class:"w-full h-screen"},null,8,j)])):o(c).data?.length?V("",!0):(u(),i("div",q,[n("div",O,[n("div",Y,[n("div",H,S(e.__("You are not enrolled in this course. Please enroll to access this lesson.")),1),_(o(I),{variant:"solid",onClick:t[0]||(t[0]=J=>v())},{default:D(()=>[R(S(e.__("Start Learning")),1)]),_:1})])])]))],64))}};export{_e as default};
