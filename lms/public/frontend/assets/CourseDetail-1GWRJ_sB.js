import{x as F,u as G,i as T,z as M,L as x,r as z,c as d,o as r,h as _,d as s,t as n,p as e,E as g,b as l,w as f,H as k,e as C,M as j,q as L,N as H,U as I,O as W,S as P,Q as U,R,l as Y,T as Q,V as X,W as V,X as Z,I as J,Y as K,D as O,g as ee,F as $,f as N,Z as B,B as se,a as te,$ as E}from"./index-RevCnO16.js";import{_ as ae}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CeasAM64.js";import{_ as re}from"./CertificationLinks-COK-c8oW.js";import{_ as oe}from"./CourseOutline-BsrqITMd.js";import{_ as D}from"./UserAvatar-6CYw18x4.js";import{_ as ne}from"./Rating.vue_vue_type_script_setup_true_lang-sA2VSiVs.js";import{_ as le}from"./CourseInstructors-DpcoSywQ.js";import{_ as ie}from"./CourseCard-s1LchMm6.js";import"./vuedraggable.umd-Cwiqepd0.js";import"./ProgressBar-D6f4tpmc.js";const ue={class:"border-2 rounded-md min-w-80"},ce=["src"],de={class:"p-5"},me={key:0,class:"text-2xl font-semibold mb-3"},_e={key:1},fe={key:0,class:"space-y-2"},pe={class:"space-y-4"},he={class:"flex items-center text-ink-gray-9"},ve={class:"ml-2"},ge={class:"flex items-center text-ink-gray-9"},we={class:"ml-2"},be={key:0,class:"flex items-center text-ink-gray-9"},ye={class:"ml-2"},ke={key:1,class:"flex items-center font-semibold text-ink-gray-9"},$e={class:"ml-2"},xe={key:2,class:"flex items-center font-semibold text-ink-gray-9"},Ne={class:"ml-2"},Re={__name:"CourseCardOverlay",props:{course:{type:Object,default:null}},setup(a){const v=G(),c=T("$user"),t=window.read_only_mode,o=a,p=M(()=>o.course.data.video_link?"https://www.youtube.com/embed/"+o.course.data.video_link:null);function w(){c.data?Y("lms.lms.doctype.lms_enrollment.lms_enrollment.create_membership",{course:o.course.data.name}).then(()=>{Q("enrolled_in_course",{course:o.course.data.name}),R.success(__("You have been enrolled in this course")),setTimeout(()=>{v.push({name:"Lesson",params:{courseName:o.course.data.name,chapterNumber:1,lessonNumber:1}})},1e3)}).catch(i=>{R.warning(__(i.messages?.[0]||i)),console.error(i)}):(R.success(__("You need to login first to enroll for this course")),setTimeout(()=>{window.location.href=`/login?redirect-to=${window.location.pathname}`},500))}const b=()=>{let i=!1;return o.course.data.instructors.forEach(y=>{!i&&y.name==c.data?.name&&(i=!0)}),i},m=M(()=>!!(o.course.data?.enable_certification&&o.course.data?.membership?.progress==100)),h=x({url:"lms.lms.doctype.lms_certificate.lms_certificate.create_certificate",makeParams(i){return{course:i.course}},onSuccess(i){window.open(`/api/method/frappe.utils.print_format.download_pdf?doctype=LMS+Certificate&name=${i.name}&format=${encodeURIComponent(i.template)}`,"_blank")}}),u=()=>{h.submit({course:o.course.data?.name,member:c.data?.name})};return(i,y)=>{const S=z("router-link");return r(),d("div",ue,[a.course.data.video_link?(r(),d("iframe",{key:0,src:p.value,class:"rounded-t-md min-h-56 w-full"},null,8,ce)):_("",!0),s("div",de,[a.course.data.paid_course?(r(),d("div",me,n(a.course.data.price),1)):_("",!0),e(t)?_("",!0):(r(),d("div",_e,[a.course.data.membership?(r(),d("div",fe,[l(S,{to:{name:"Lesson",params:{courseName:a.course.name,chapterNumber:a.course.data.current_lesson?a.course.data.current_lesson.split("-")[0]:1,lessonNumber:a.course.data.current_lesson?a.course.data.current_lesson.split("-")[1]:1}}},{default:f(()=>[l(e(k),{variant:"solid",size:"md",class:"w-full"},{default:f(()=>[s("span",null,n(i.__("Continue Learning")),1)]),_:1})]),_:1},8,["to"]),l(re,{courseName:a.course.data.name,class:"w-full"},null,8,["courseName"])])):a.course.data.paid_course?(r(),g(S,{key:1,to:{name:"Billing",params:{type:"course",name:a.course.data.name}}},{default:f(()=>[l(e(k),{variant:"solid",size:"md",class:"w-full"},{default:f(()=>[s("span",null,n(i.__("Buy this course")),1)]),_:1})]),_:1},8,["to"])):a.course.data.disable_self_learning?(r(),g(e(j),{key:2,theme:"blue",size:"lg"},{default:f(()=>[C(n(i.__("Contact the Administrator to enroll for this course.")),1)]),_:1})):(r(),g(e(k),{key:3,onClick:y[0]||(y[0]=A=>w()),variant:"solid",class:"w-full button",size:"md"},{default:f(()=>[s("span",null,n(i.__("Start Learning")),1)]),_:1})),m.value?(r(),g(e(k),{key:4,onClick:y[1]||(y[1]=A=>u()),variant:"subtle",class:"w-full mt-2",size:"md"},{default:f(()=>[C(n(i.__("Get Certificate")),1)]),_:1})):_("",!0),e(c)?.data?.is_moderator||b()?(r(),g(S,{key:5,to:{name:"CourseForm",params:{courseName:a.course.data.name}}},{default:f(()=>[l(e(k),{variant:"subtle",class:"w-full mt-2 text-white",size:"md",style:{"background-color":"rgb(241, 81, 27)"}},{default:f(()=>[s("span",null,n(i.__("Edit")),1)]),_:1})]),_:1},8,["to"])):_("",!0)])),s("div",pe,[s("div",{class:L(["font-medium text-ink-gray-9",{"mt-8":!e(t)}])},n(i.__("This course has:")),3),s("div",he,[l(e(H),{class:"h-4 w-4 stroke-1.5"}),s("span",ve,n(a.course.data.lessons)+" "+n(i.__("Lessons")),1)]),s("div",ge,[l(e(I),{class:"h-4 w-4 stroke-1.5"}),s("span",we,n(e(W)(a.course.data.enrollments))+" "+n(i.__("Enrolled Students")),1)]),parseInt(a.course.data.rating)>0?(r(),d("div",be,[l(e(P),{class:"size-4 stroke-1.5 fill-yellow-500 text-transparent"}),s("span",ye,n(a.course.data.rating)+" "+n(i.__("Rating")),1)])):_("",!0),a.course.data.enable_certification?(r(),d("div",ke,[l(e(U),{class:"h-4 w-4 stroke-2"}),s("span",$e,n(i.__("Certificate of Completion")),1)])):_("",!0),a.course.data.paid_certificate?(r(),d("div",xe,[l(e(U),{class:"h-4 w-4 stroke-2"}),s("span",Ne,n(i.__("Paid Certificate after Evaluation")),1)])):_("",!0)])])])}}},q=F(Re,[["__scopeId","data-v-bbbe2e9e"]]),Ce={class:"flex flex-col gap-4"},Se={__name:"ReviewModal",props:X({courseName:{type:String,required:!0}},{modelValue:{},modelModifiers:{},reloadReviews:{},reloadReviewsModifiers:{},hasReviewed:{},hasReviewedModifiers:{}}),emits:["update:modelValue","update:reloadReviews","update:hasReviewed"],setup(a){const v=V(a,"modelValue"),c=V(a,"reloadReviews"),t=V(a,"hasReviewed");let o=Z({review:"",rating:0});const p=a,w=x({url:"frappe.client.insert",makeParams(m){return{doc:{doctype:"LMS Course Review",course:p.courseName,...m}}}});function b(m){o.rating=o.rating/5,w.submit(o,{validate(){if(!o.rating)return"Please enter a rating."},onSuccess(){c.value.reload(),t.value.reload()},onError(h){R.error(h.messages?.[0]||h)}}),m()}return(m,h)=>(r(),g(e(K),{modelValue:v.value,"onUpdate:modelValue":h[2]||(h[2]=u=>v.value=u),options:{title:m.__("Write a Review"),size:"xl",actions:[{label:"Submit",variant:"solid",onClick:u=>b(u)}]}},{"body-content":f(()=>[s("div",Ce,[l(e(ne),{modelValue:e(o).rating,"onUpdate:modelValue":h[0]||(h[0]=u=>e(o).rating=u),label:m.__("Rating")},null,8,["modelValue","label"]),l(e(J),{label:m.__("Review"),type:"textarea",modelValue:e(o).review,"onUpdate:modelValue":h[1]||(h[1]=u=>e(o).review=u),rows:5},null,8,["label","modelValue"])])]),_:1},8,["modelValue","options"]))}},Ve={key:0,class:"mt-20 mb-10"},Me={class:"flex items-center font-semibold text-2xl text-ink-gray-9"},ze={class:"grid gap-8 mt-10"},Le={class:"flex items-center"},Pe={class:"mx-4"},Oe={class:"text-lg font-medium mr-4 text-ink-gray-7"},Ue={class:"text-ink-gray-7"},Be={class:"flex mt-2 space-x-1"},Ee={key:0,class:"mt-4 leading-5 text-ink-gray-7"},qe={__name:"CourseReviews",props:{courseName:{type:String,required:!0},avg_rating:{type:String,required:!0},membership:{type:Object,required:!1}},setup(a){const v=T("$user"),c=a,t=x({url:"frappe.client.get_count",cache:["eligible_to_review",c.courseName,c.membership?.member],params:{doctype:"LMS Course Review",filters:{course:c.courseName,owner:c.membership?.member}},auto:!!v.data?.name}),o=x({url:"lms.lms.utils.get_reviews",cache:["course_reviews",c.courseName],makeParams(){return{course:c.courseName}},auto:!0});O(()=>c.courseName,()=>{o.reload()});const p=ee(!1);function w(){p.value=!0}return(b,m)=>{const h=z("router-link");return r(),d($,null,[e(o).data?.length||a.membership?(r(),d("div",Ve,[a.membership&&!e(t).data?(r(),g(e(k),{key:0,onClick:m[0]||(m[0]=u=>w()),class:"float-right"},{default:f(()=>[C(n(b.__("Write a Review")),1)]),_:1})):_("",!0),s("div",Me,n(b.__("Student Reviews")),1),s("div",ze,[(r(!0),d($,null,N(e(o).data,(u,i)=>(r(),d("div",null,[s("div",Le,[l(h,{to:{name:"Profile",params:{username:u.owner_details.username}}},{default:f(()=>[l(D,{user:u.owner_details,size:"2xl"},null,8,["user"])]),_:2},1032,["to"]),s("div",Pe,[l(h,{to:{name:"Profile",params:{username:u.owner_details.username}}},{default:f(()=>[s("span",Oe,n(u.owner_details.full_name),1)]),_:2},1032,["to"]),s("span",Ue,n(u.creation),1),s("div",Be,[(r(),d($,null,N(5,y=>l(e(P),{class:L(["size-4 text-transparent rounded-sm",y<=Math.ceil(u.rating)?"fill-yellow-500":"fill-gray-300"])},null,8,["class"])),64))])])]),u.review?(r(),d("div",Ee,n(u.review),1)):_("",!0)]))),256))])])):_("",!0),l(Se,{modelValue:p.value,"onUpdate:modelValue":m[1]||(m[1]=u=>p.value=u),reloadReviews:e(o),"onUpdate:reloadReviews":m[2]||(m[2]=u=>B(o)?o.value=u:null),hasReviewed:e(t),"onUpdate:hasReviewed":m[3]||(m[3]=u=>B(t)?t.value=u:null),courseName:a.courseName},null,8,["modelValue","reloadReviews","hasReviewed","courseName"])],64)}}},Te={key:0,class:"mt-10"},je={class:"flex items-center justify-between mb-6"},Ie={class:"text-2xl font-semibold text-ink-gray-9"},De={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-4"},Ae={__name:"RelatedCourses",props:{courseName:{type:String,required:!0}},setup(a){const v=a,c=x({url:"lms.lms.utils.get_related_courses",cache:["related_courses",v.courseName],makeParams(){return{course:v.courseName}},auto:!0});return O(()=>v.courseName,()=>{c.reload()}),(t,o)=>{const p=z("router-link");return e(c).data?.length?(r(),d("div",Te,[s("div",je,[s("div",Ie,n(t.__("Related Courses")),1)]),s("div",De,[(r(!0),d($,null,N(e(c).data,w=>(r(),g(p,{key:w.name,to:{name:"CourseDetail",params:{courseName:w.name}},class:"cursor-pointer"},{default:f(()=>[l(ie,{course:w},null,8,["course"])]),_:2},1032,["to"]))),128))])])):_("",!0)}}},Fe={key:0},Ge={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},He={class:"m-5"},We={class:"flex justify-between w-full"},Ye={class:"md:w-2/3"},Qe={class:"text-3xl font-semibold text-ink-gray-9"},Xe={class:"my-3 leading-6 text-ink-gray-7"},Ze={class:"flex items-center"},Je={class:"ml-1 text-ink-gray-7"},Ke={key:1,class:"mx-3"},es={class:"ml-1"},ss={key:3,class:"mx-3"},ts={class:"flex items-center"},as={key:0,class:"flex my-4 w-fit"},rs=["innerHTML"],os={class:"mt-10"},ns={class:"hidden md:block"},vs={__name:"CourseDetail",props:{courseName:{type:String,required:!0}},setup(a){const{brand:v}=se(),c=a,t=x({url:"lms.lms.utils.get_course_details",cache:["course",c.courseName],makeParams(){return{course:c.courseName}},auto:!0});O(()=>c.courseName,()=>{t.reload()});const o=M(()=>{let p=[{label:"Courses",route:{name:"Courses"}}];return p.push({label:t?.data?.title,route:{name:"CourseDetail",params:{courseName:t?.data?.name}}}),p});return te(()=>({title:t?.data?.title,icon:v.favicon})),(p,w)=>e(t).data?(r(),d("div",Fe,[s("header",Ge,[l(e(ae),{class:"h-7",items:o.value},null,8,["items"])]),s("div",He,[s("div",We,[s("div",Ye,[s("div",Qe,n(e(t).data.title),1),s("div",Xe,n(e(t).data.short_introduction),1),s("div",Ze,[parseInt(e(t).data.rating)>0?(r(),g(e(E),{key:0,text:p.__("Average Rating"),class:"flex items-center"},{default:f(()=>[l(e(P),{class:"size-4 text-transparent fill-yellow-500"}),s("span",Je,n(e(t).data.rating),1)]),_:1},8,["text"])):_("",!0),parseInt(e(t).data.rating)>0?(r(),d("span",Ke,"·")):_("",!0),e(t).data.enrollment_count?(r(),g(e(E),{key:2,text:p.__("Enrolled Students"),class:"flex items-center"},{default:f(()=>[l(e(I),{class:"h-4 w-4 text-ink-gray-7"}),s("span",es,n(e(t).data.enrollment_count_formatted),1)]),_:1},8,["text"])):_("",!0),e(t).data.enrollment_count?(r(),d("span",ss,"·")):_("",!0),s("div",ts,[s("span",{class:L(["h-6 mr-1",{"avatar-group overlap":e(t).data.instructors.length>1}])},[(r(!0),d($,null,N(e(t).data.instructors,b=>(r(),g(D,{user:b},null,8,["user"]))),256))],2),l(le,{instructors:e(t).data.instructors},null,8,["instructors"])])]),e(t).data.tags?(r(),d("div",as,[(r(!0),d($,null,N(e(t).data.tags.split(", "),b=>(r(),g(e(j),{theme:"gray",size:"lg",class:"mr-2 text-ink-gray-9"},{default:f(()=>[C(n(b),1)]),_:2},1024))),256))])):_("",!0),l(q,{course:e(t),class:"md:hidden mb-4"},null,8,["course"]),s("div",{innerHTML:e(t).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-10"},null,8,rs),s("div",os,[l(oe,{title:p.__("Course Outline"),courseName:e(t).data.name,showOutline:!0},null,8,["title","courseName"])]),l(qe,{courseName:e(t).data.name,avg_rating:e(t).data.rating,membership:e(t).data.membership},null,8,["courseName","avg_rating","membership"])]),s("div",ns,[l(q,{course:e(t)},null,8,["course"])])]),l(Ae,{courseName:e(t).data.name},null,8,["courseName"])])])):_("",!0)}};export{vs as default};
//# sourceMappingURL=CourseDetail-1GWRJ_sB.js.map
