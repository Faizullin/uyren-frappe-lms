import{e as c,f as n,g as i,k as f,t as u,p as D,h as m,l as o,a6 as W,a7 as F,a8 as X,F as Y,x as j,j as p,C as Z,i as M,s as ee,r as v,b as S,o as te,c as ae,w as le,u as se,d as oe,n as w,_ as U,P as ne,q as L,v as re}from"./index-DcFDtKzU.js";import{_ as ie}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DSPCRa1r.js";import{T as ue}from"./TabButtons-BDuiRaD6.js";import{_ as ce}from"./DateRange-BXya_-do.js";import{_ as de}from"./CourseInstructors-B8w7xX0Z.js";import{_ as me}from"./UserAvatar-CrXqRFgS.js";import{_ as fe}from"./EmptyState.vue_vue_type_script_setup_true_lang-BkDFSWzK.js";const ve={class:"flex flex-col border hover:border-outline-gray-3 rounded-md p-4 h-full",style:{"min-height":"150px"}},he={class:"text-lg leading-5 font-semibold mb-2 text-ink-gray-9"},ge={key:0,class:"text-xs bg-green-100 text-green-700 self-start px-2 py-0.5 rounded-md"},_e={key:0},be={key:1},ye={key:1,class:"text-xs bg-red-100 text-red-700 self-start px-2 py-0.5 rounded-md"},pe={class:"short-introduction text-sm text-ink-gray-7"},xe={key:2,class:"font-semibold text-ink-gray-9 mb-4"},ke={class:"flex flex-col space-y-2 mt-auto"},$e={class:"flex items-center text-sm text-ink-gray-7"},we={key:0,class:"flex items-center text-sm text-ink-gray-7"},Be={key:3,class:"flex avatar-group overlap mt-4"},Ce={__name:"BatchCard",props:{batch:{type:Object,default:null}},setup(a){return(r,B)=>(n(),c("div",ve,[i("div",he,u(a.batch.title),1),a.batch.seat_count&&a.batch.seats_left>0?(n(),c("div",ge,[D(u(a.batch.seats_left)+" ",1),a.batch.seats_left>1?(n(),c("span",_e,u(r.__("Seats Left")),1)):a.batch.seats_left==1?(n(),c("span",be,u(r.__("Seat Left")),1)):f("",!0)])):a.batch.seat_count&&a.batch.seats_left<=0?(n(),c("div",ye,u(r.__("Sold Out")),1)):f("",!0),i("div",pe,u(a.batch.description),1),a.batch.amount?(n(),c("div",xe,u(a.batch.price),1)):f("",!0),i("div",ke,[m(ce,{startDate:a.batch.start_date,endDate:a.batch.end_date,class:"text-sm text-ink-gray-7"},null,8,["startDate","endDate"]),i("div",$e,[m(o(W),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-7"}),i("span",null,u(o(F)(a.batch.start_time))+" - "+u(o(F)(a.batch.end_time)),1)]),a.batch.timezone?(n(),c("div",we,[m(o(X),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-5"}),i("span",null,u(a.batch.timezone),1)])):f("",!0)]),a.batch.instructors?.length?(n(),c("div",Be,[i("div",{class:Z(["h-6 mr-1",{"avatar-group overlap":a.batch.instructors.length>1}])},[(n(!0),c(Y,null,j(a.batch.instructors,V=>(n(),p(me,{user:V},null,8,["user"]))),256))],2),m(de,{instructors:a.batch.instructors},null,8,["instructors"])])):f("",!0)]))}},Ve={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},Se={class:"p-5 pb-10"},De={class:"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:items-center justify-between mb-5"},Ye={class:"text-lg text-ink-gray-9 font-semibold"},Fe={class:"flex flex-col space-y-2 lg:space-y-0 lg:flex-row lg:items-center lg:space-x-4"},Me={class:"grid grid-cols-2 gap-2"},Ue={class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40"},Le={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5"},je={key:2,class:"flex justify-center mt-5"},ze={__name:"Batches",setup(a){const r=M("$user"),B=M("$dayjs"),{brand:V}=ee(),T=v(0),N=v(20),_=v([]),b=v(null),y=v(""),x=v(!1),s=v({}),C=S(()=>r.data?.is_student),h=v(C.value?"All":"Upcoming"),k=v("start_date"),P=window.read_only_mode;te(()=>{E(),$(),_.value=[{label:"",value:null}]});const E=()=>{let t=new URLSearchParams(location.search);y.value=t.get("title")||"",b.value=t.get("category")||null,x.value=t.get("certification")||!1},g=ae({doctype:"LMS Batch",url:"lms.lms.utils.get_batches",cache:["batches",r.data?.name],pageLength:N.value,start:T.value,onSuccess(t){let e=t.map(d=>d.category);e=e.filter((d,l)=>e.indexOf(d)===l&&d),_.value.length<=e.length&&I(t)}}),$=()=>{A(),g.update({filters:s.value,orderBy:k.value}),g.reload()},A=()=>{O(),q(),z(),R(),Q(),G()},O=()=>{b.value?s.value.category=b.value:delete s.value.category},q=()=>{y.value?s.value.title=["like",`%${y.value}%`]:delete s.value.title},z=()=>{x.value?s.value.certification=1:delete s.value.certification},R=()=>{k.value="start_date",r.data&&(h.value=="Enrolled"&&C.value?(s.value.enrolled=1,delete s.value.start_date,delete s.value.published,k.value="start_date desc"):C.value?delete s.value.enrolled:(delete s.value.start_date,delete s.value.published,k.value="start_date desc",h.value=="Upcoming"?(s.value.start_date=[">=",B().format("YYYY-MM-DD")],s.value.published=1,k.value="start_date"):h.value=="Archived"?s.value.start_date=["<=",B().format("YYYY-MM-DD")]:h.value=="Unpublished"&&(s.value.published=0)))},Q=()=>{(!r.data||C.value&&h.value!="Enrolled")&&(s.value.start_date=[">=",B().format("YYYY-MM-DD")],s.value.published=1)},G=()=>{let t=new URLSearchParams(location.search),e={title:y.value,category:b.value,certification:x.value};Object.keys(e).forEach(l=>{e[l]?t.set(l,e[l]):t.delete(l)});let d="";t.toString()&&(d=`?${t.toString()}`),history.replaceState({},"",`${location.pathname}${d}`)},I=t=>{t.forEach(e=>{e.category&&!_.value.find(d=>d.value===e.category)&&_.value.push({label:e.category,value:e.category})})};le(h,()=>{$()});const K=S(()=>{let t=[{label:__("All")}];return r.data?.is_moderator||r.data?.is_instructor||r.data?.is_evaluator?(t.push({label:__("Upcoming")}),t.push({label:__("Archived")}),t.push({label:__("Unpublished")})):r.data&&t.push({label:__("Enrolled")}),t}),H=()=>P?!1:!!(r.data?.is_moderator||r.data?.is_instructor),J=S(()=>[{label:__("Batches"),route:{name:"Batches"}}]);return se(()=>({title:__("Batches"),icon:V.favicon})),(t,e)=>{const d=oe("router-link");return n(),c(Y,null,[i("header",Ve,[m(o(ie),{items:J.value},null,8,["items"]),H()?(n(),p(d,{key:0,to:{name:"BatchForm",params:{batchName:"new"}}},{default:w(()=>[m(o(U),{variant:"solid"},{prefix:w(()=>[m(o(ne),{class:"h-4 w-4 stroke-1.5"})]),default:w(()=>[D(" "+u(t.__("New")),1)]),_:1})]),_:1})):f("",!0)]),i("div",Se,[i("div",De,[i("div",Ye,u(t.__("All Batches")),1),i("div",Fe,[o(r).data?(n(),p(o(ue),{key:0,buttons:K.value,modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l)},null,8,["buttons","modelValue"])):f("",!0),m(o(L),{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=l=>x.value=l),label:t.__("Certification"),type:"checkbox",onChange:e[2]||(e[2]=l=>$())},null,8,["modelValue","label"]),i("div",Me,[m(o(L),{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=l=>y.value=l),placeholder:t.__("Search by Title"),type:"text",class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40",onInput:e[4]||(e[4]=l=>$())},null,8,["modelValue","placeholder"]),i("div",Ue,[_.value.length?(n(),p(o(re),{key:0,modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=l=>b.value=l),options:_.value,placeholder:t.__("Category"),onChange:e[6]||(e[6]=l=>$())},null,8,["modelValue","options","placeholder"])):f("",!0)])])])]),o(g).data?.length?(n(),c("div",Le,[(n(!0),c(Y,null,j(o(g).data,l=>(n(),p(d,{to:{name:"BatchDetail",params:{batchName:l.name}}},{default:w(()=>[m(Ce,{batch:l},null,8,["batch"])]),_:2},1032,["to"]))),256))])):o(g).list.loading?f("",!0):(n(),p(fe,{key:1,type:"Batches"})),!o(g).list.loading&&o(g).hasNextPage?(n(),c("div",je,[m(o(U),{onClick:e[7]||(e[7]=l=>o(g).next())},{default:w(()=>[D(u(t.__("Load More")),1)]),_:1})])):f("",!0)])],64)}}};export{ze as default};
//# sourceMappingURL=Batches-BMxLWaFw.js.map
