import{Q as K,R,cB as T,g as f,q as _,cC as A,I,c as u,o,h as x,d as r,n as B,e as L,t as g,b as c,w as p,s as l,bA as U,k as G,cD as Q,F as M,f as S,B as X,cE as H,D as J,P as W,br as Y,cF as Z,b$ as ee,j as te,cG as se,bv as ae,a9 as le}from"./index-CgbsATbs.js";const oe={key:0,class:"text-ink-red-3"},re={class:"w-full"},ue={class:"mt-1 rounded-lg bg-surface-white py-1 text-base border-2"},ne={class:"flex flex-col gap-1 p-1"},ie={class:"text-base font-medium text-ink-gray-8"},ce={class:"text-sm text-ink-gray-5"},de={key:0,class:"absolute bottom-2 left-1 w-[99%] pt-2 bg-white border-t"},fe={key:1,class:"grid grid-cols-2 gap-2 mt-1"},pe={class:"flex items-center justify-between break-all bg-[#f1511b] text-white word-wrap p-2 rounded-md mr-2"},me={class:"break-all"},be={__name:"MultiSelect",props:K({label:{type:String},size:{type:String,default:"sm"},doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},validate:{type:Function,default:null},errorMessage:{type:Function,default:n=>`${n} is an Invalid value`},required:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n,{expose:q}){const i=n,a=R(n,"modelValue"),V=T(),v=f([]),C=f(null),w=f(null),d=f(""),b=f(""),h=f(!1),F=_({get:()=>d.value||"",set:e=>{d.value="",e&&(h.value=!1),e?.value&&j(e.value)}});A(d,e=>{e=e||"",b.value!==e&&(b.value=e,N(e))},{debounce:300,immediate:!0});const k=I({url:"frappe.desk.search.search_link",method:"POST",cache:[b.value,i.doctype],auto:!0,params:{txt:b.value,doctype:i.doctype}}),D=_(()=>k.data||[]);function N(e){k.update({params:{txt:e,doctype:i.doctype}}),k.reload()}const j=e=>{w.value=null,e&&(e.split(",").forEach(t=>{if(t=t.trim(),t&&!a.value?.includes(t)){if(t&&i.validate&&!i.validate(t)){w.value=i.errorMessage(t);return}a.value?a.value.push(t):a.value=[t],t=t.replace(t,"")}}),!w.value&&(e=""))},z=e=>{a.value=a.value.filter(s=>s!==e)},E=()=>{if(d.value)return;let e=v.value[v.value.length-1]?.$el;document.activeElement===e?(a.value.pop(),le(()=>{a.value.length?(e=v.value[v.value.length-1].$el,e?.focus()):$()})):e?.focus()};function $(){C.value.$el.focus()}q({setFocus:$});const O=_(()=>[{sm:"text-xs",md:"text-base"}[i.size||"sm"],"text-ink-gray-5"]);return(e,s)=>(o(),u("div",null,[n.label?(o(),u("label",{key:0,class:B(["block mb-1",O.value])},[L(g(n.label)+" ",1),n.required?(o(),u("span",oe,"*")):x("",!0)],2)):x("",!0),r("div",re,[c(l(se),{modelValue:F.value,"onUpdate:modelValue":s[2]||(s[2]=t=>F.value=t),nullable:""},{default:p(()=>[c(l(U),{class:"w-full",show:h.value,"onUpdate:show":s[1]||(s[1]=t=>h.value=t)},{target:p(({togglePopover:t})=>[c(l(Z),{ref_key:"search",ref:C,class:"search-input form-input w-full border-[#f1511b] hover:border-[#f1511b] focus:ring-[#f1511b] focus:border-[#f1511b] focus-visible:ring-[#f1511b] transition-colors",type:"text",value:d.value,onChange:s[0]||(s[0]=y=>{d.value=y.target.value,h.value=!0}),autocomplete:"off",onFocus:()=>t(),onKeydownCapture:ee(te(E,["stop"]),["delete"])},null,8,["value","onFocus","onKeydownCapture"])]),body:p(({isOpen:t,close:y})=>[G(r("div",null,[r("div",ue,[c(l(Q),{class:"my-1 min-h-[6rem] max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:p(()=>[(o(!0),u(M,null,S(D.value,m=>(o(),X(l(H),{key:m.value,value:m},{default:p(({active:P})=>[r("li",{class:B(["flex cursor-pointer items-center rounded px-2 py-1 text-base transition-colors",P?"bg-[#f1511b] text-white [&_*]:text-white":""])},[r("div",ne,[r("div",ie,g(m.description),1),r("div",ce,g(m.value),1)])],2)]),_:2},1032,["value"]))),128)),s[3]||(s[3]=r("div",{class:"h-10"},null,-1)),l(V).onCreate?(o(),u("div",de,[c(l(J),{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),onClick:m=>l(V).onCreate(y)},{prefix:p(()=>[c(l(W),{class:"h-4 w-4 stroke-1.5 text-[#f1511b]"})]),_:2},1032,["label","onClick"])])):x("",!0)]),_:2,__:[3]},1024)])],512),[[Y,t]])]),_:1},8,["show"])]),_:1},8,["modelValue"])]),a.value.length?(o(),u("div",fe,[(o(!0),u(M,null,S(a.value,t=>(o(),u("div",pe,[r("span",me,g(t),1),c(l(ae),{class:"size-4 stroke-1.5 cursor-pointer text-white",onClick:y=>z(t)},null,8,["onClick"])]))),256))])):x("",!0)]))}};export{be as _};
//# sourceMappingURL=MultiSelect-tLY7C5yN.js.map
