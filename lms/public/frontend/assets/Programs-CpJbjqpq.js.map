{"version":3,"file":"Programs-CpJbjqpq.js","sources":["../../../../frontend-monorepo/website/src/pages/Programs.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadbrumbs\" />\n\t\t<Button\n\t\t\tv-if=\"canCreateProgram()\"\n\t\t\t@click=\"showDialog = true\"\n\t\t\tvariant=\"solid\"\n\t\t>\n\t\t\t<template #prefix>\n\t\t\t\t<Plus class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t</template>\n\t\t\t{{ __('New') }}\n\t\t</Button>\n\t</header>\n\t<div v-if=\"programs.data?.length\" class=\"pt-5 px-5\">\n\t\t<div v-for=\"program in programs.data\" class=\"mb-10\">\n\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t<div class=\"text-xl text-ink-gray-9 font-semibold\">\n\t\t\t\t\t{{ program.name }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tv-if=\"program.members\"\n\t\t\t\t\t\tvariant=\"subtle\"\n\t\t\t\t\t\ttheme=\"green\"\n\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ program.members }}\n\t\t\t\t\t\t{{ program.members == 1 ? __('member') : __('members') }}\n\t\t\t\t\t</Badge>\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tv-if=\"program.progress\"\n\t\t\t\t\t\tvariant=\"subtle\"\n\t\t\t\t\t\ttheme=\"blue\"\n\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ program.progress }}{{ __('% completed') }}\n\t\t\t\t\t</Badge>\n\n\t\t\t\t\t<router-link\n\t\t\t\t\t\tv-if=\"user.data?.is_moderator || user.data?.is_instructor\"\n\t\t\t\t\t\t:to=\"{\n\t\t\t\t\t\t\tname: 'ProgramForm',\n\t\t\t\t\t\t\tparams: { programName: program.name },\n\t\t\t\t\t\t}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Button v-if=\"!readOnlyMode\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<Edit class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ __('Edit') }}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</router-link>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"program.courses?.length\"\n\t\t\t\tclass=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mt-5\"\n\t\t\t>\n\t\t\t\t<div v-for=\"course in program.courses\" class=\"relative group\">\n\t\t\t\t\t<CourseCard\n\t\t\t\t\t\t:course=\"course\"\n\t\t\t\t\t\t@click=\"enrollMember(program.name, course.name)\"\n\t\t\t\t\t\tclass=\"cursor-pointer\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"lockCourse(course)\"\n\t\t\t\t\t\tclass=\"absolute inset-0 bg-black-overlay-500 opacity-60 rounded-md\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"lockCourse(course)\"\n\t\t\t\t\t\tclass=\"absolute inset-0 flex items-center justify-center\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<LockKeyhole class=\"size-10 text-ink-white\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-else class=\"text-sm italic text-ink-gray-5 mt-4\">\n\t\t\t\t{{ __('No courses in this program') }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<EmptyState v-else type=\"Programs\" />\n\n\t<Dialog\n\t\tv-model=\"showDialog\"\n\t\t:options=\"{\n\t\t\ttitle: __('New Program'),\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: __('Create'),\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick: () => createProgram(close),\n\t\t\t\t},\n\t\t\t],\n\t\t}\"\n\t>\n\t\t<template #body-content>\n\t\t\t<FormControl :label=\"__('Title')\" v-model=\"title\" />\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tBreadcrumbs,\n\tButton,\n\tcall,\n\tcreateResource,\n\tDialog,\n\tFormControl,\n\tusePageMeta,\n\ttoast,\n} from '@mono/mono-frappe-ui'\nimport { computed, inject, onMounted, ref } from 'vue'\nimport { Edit, Plus, LockKeyhole } from 'lucide-vue-next'\nimport CourseCard from '@/components/CourseCard.vue'\nimport EmptyState from '@/components/EmptyState.vue'\nimport { useRouter } from 'vue-router'\nimport { sessionStore } from '../stores/session'\nimport { useSettings } from '@/stores/settings'\n\nconst { brand } = sessionStore()\nconst user = inject('$user')\nconst showDialog = ref(false)\nconst router = useRouter()\nconst title = ref('')\nconst settings = useSettings()\nconst readOnlyMode = window.read_only_mode\n\nonMounted(() => {\n\tif (\n\t\t!settings.learningPaths.data &&\n\t\t!user.data?.is_moderator &&\n\t\t!user.data?.is_instructor\n\t) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n})\n\nconst programs = createResource({\n\turl: 'lms.lms.utils.get_programs',\n\tauto: true,\n\tcache: 'programs',\n})\n\nconst createProgram = (close) => {\n\tcall('frappe.client.insert', {\n\t\tdoc: {\n\t\t\tdoctype: 'LMS Program',\n\t\t\ttitle: title.value,\n\t\t},\n\t}).then((res) => {\n\t\trouter.push({ name: 'ProgramForm', params: { programName: res.name } })\n\t})\n}\n\nconst enrollMember = (program, course) => {\n\tcall('lms.lms.utils.enroll_in_program_course', {\n\t\tprogram: program,\n\t\tcourse: course,\n\t})\n\t\t.then((data) => {\n\t\t\tif (data.current_lesson) {\n\t\t\t\trouter.push({\n\t\t\t\t\tname: 'Lesson',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tcourseName: course,\n\t\t\t\t\t\tchapterNumber: data.current_lesson.split('-')[0],\n\t\t\t\t\t\tlessonNumber: data.current_lesson.split('-')[1],\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t} else if (data) {\n\t\t\t\trouter.push({\n\t\t\t\t\tname: 'Lesson',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tcourseName: course,\n\t\t\t\t\t\tchapterNumber: 1,\n\t\t\t\t\t\tlessonNumber: 1,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t\t.catch((err) => {\n\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t})\n}\n\nconst lockCourse = (course) => {\n\tif (user.data?.is_moderator || user.data?.is_instructor) return false\n\tif (course.membership) return false\n\tif (course.eligible) return false\n\treturn true\n}\n\nconst canCreateProgram = () => {\n\tif (readOnlyMode) return false\n\tif (user.data?.is_moderator || user.data?.is_instructor) return true\n\treturn false\n}\n\nconst breadbrumbs = computed(() => [\n\t{\n\t\tlabel: __('Programs'),\n\t},\n])\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Programs'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n"],"names":["brand","sessionStore","user","inject","showDialog","ref","router","useRouter","title","settings","useSettings","readOnlyMode","onMounted","programs","createResource","createProgram","close","call","res","enrollMember","program","course","data","err","toast","lockCourse","canCreateProgram","breadbrumbs","computed","usePageMeta","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_createBlock","Button","Plus","_createTextVNode","__","_openBlock","_createElementBlock","_hoisted_2","_Fragment","_renderList","_hoisted_3","_hoisted_4","_hoisted_5","_toDisplayString","_hoisted_6","Badge","_component_router_link","Edit","_hoisted_7","_hoisted_8","CourseCard","$event","_hoisted_9","_hoisted_10","LockKeyhole","_hoisted_11","EmptyState","Dialog","FormControl"],"mappings":"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"}