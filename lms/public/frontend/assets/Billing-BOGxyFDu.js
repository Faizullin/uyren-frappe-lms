import"@headlessui/vue";import{e as b,f as p,g as l,p as h,t as i,h as d,n as P,l as n,_ as L,i as U,s as A,o as T,A as f,L as z,b as D,H as v,u as E,k as _,q as c,j as k,af as V}from"./index-BIerRe8o.js";import{_ as G}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Cdx-1Hlv.js";import"@tiptap/extension-code-block-lowlight";import"@tiptap/extension-placeholder";import"@tiptap/extension-table";import"@tiptap/extension-table-cell";import"@tiptap/extension-table-header";import"@tiptap/extension-table-row";import"@tiptap/extension-text-align";import"@tiptap/extension-text-style";import"@tiptap/extension-typography";import"@tiptap/vue-3";import"@tiptap/extension-mention";import"@vueuse/core";import"@tiptap/core";import"@tiptap/extension-code-block";import"@tiptap/extension-heading";import"@tiptap/suggestion";import"@tiptap/extension-link";const I={class:"text-base border rounded-md w-1/3 mx-auto my-32"},q={class:"border-b px-5 py-3 font-medium"},H={class:"px-5 py-3"},K={class:"mb-4 leading-6"},w={__name:"NotPermitted",props:{title:{type:String,default:"Not Permitted"},text:{type:String,default:"You are not permitted to access this page."},buttonLabel:{type:String,default:"Login"},buttonLink:{type:String,default:"/login"}},setup(u){const y=u,g=()=>{window.location.href=y.buttonLink};return(o,m)=>(p(),b("div",I,[l("div",q,[m[1]||(m[1]=l("span",{class:"inline-flex items-center before:bg-surface-red-5 before:w-2 before:h-2 before:rounded-md before:mr-2"},null,-1)),h(" "+i(o.__(u.title)),1)]),l("div",H,[l("div",K,i(o.__(u.text)),1),d(n(L),{variant:"solid",class:"w-full",onClick:m[0]||(m[0]=r=>g())},{default:P(()=>[h(i(o.__(u.buttonLabel)),1)]),_:1})])]))}},J={class:""},O={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},R={key:0,class:"pt-5 pb-10 mx-5"},W={class:"flex flex-col lg:flex-row justify-between"},F={class:"h-fit bg-surface-gray-2 rounded-md p-5 space-y-4 lg:order-last mb-10 lg:mt-10 font-medium lg:w-1/3"},Y={class:"flex items-baseline justify-between space-y-2"},Q={class:"text-ink-gray-5"},X={class:"leading-5"},Z={key:0,class:"flex items-center justify-between"},ee={class:"text-ink-gray-5"},te={class:""},ae={key:1,class:"flex items-center justify-between mt-2"},se={class:"text-ink-gray-5"},le={class:"flex items-center justify-between border-t border-outline-gray-3 pt-4 mt-2"},ne={class:"text-lg font-semibold"},oe={class:"text-lg font-semibold"},ie={class:"flex-1 lg:mr-10"},re={class:"mb-5"},de={class:"text-lg font-semibold"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},me={class:"space-y-4"},ce={class:"space-y-4"},pe={class:"flex items-center justify-between border-t pt-4 mt-8"},be={class:"text-ink-gray-5"},_e={key:1},ye={key:2},ze={__name:"Billing",props:{type:{type:String,required:!0},name:{type:String,required:!0}},setup(u){const y=U("$user"),{brand:g}=A();T(()=>{const e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",document.body.appendChild(e),y.data?.name&&m.submit()});const o=u,m=f({url:"lms.lms.api.validate_billing_access",params:{billing_type:o.type,name:o.name},onSuccess(e){S(e.address),r.submit()}}),r=f({url:"lms.lms.utils.get_order_summary",makeParams(e){return{doctype:o.type=="batch"?"LMS Batch":"LMS Course",docname:o.name,country:t.country}},onError(e){j(e)}}),t=z({}),S=e=>{t.billing_name=e?.billing_name||"",t.address_line1=e?.address_line1||"",t.address_line2=e?.address_line2||"",t.city=e?.city||"",t.state=e?.state||"",t.country=e?.country||"",t.pincode=e?.pincode||"",t.phone=e?.phone||"",t.source=e?.source||"",t.gstin=e?.gstin||"",t.pan=e?.pan||""},C=f({url:"lms.lms.payments.get_payment_link",makeParams(e){return{doctype:o.type=="batch"?"LMS Batch":"LMS Course",docname:o.name,title:r.data.title,amount:r.data.original_amount,total_amount:r.data.amount,currency:r.data.currency,address:t,redirect_to:M.value,payment_for_certificate:o.type=="certificate"}}}),$=()=>{C.submit({},{validate(){return t.source?B():__("Please let us know where you heard about us from.")},onSuccess(e){window.location.href=e},onError(e){v.error(e.messages?.[0]||e)}})},B=()=>{let e=["billing_name","address_line1","city","pincode","country","phone","source"];for(let s of e)if(!t[s])return"Please enter a valid "+s.replaceAll("_"," ").toLowerCase().replace(/\b\w/g,N=>N.toUpperCase());if(t.gstin&&!t.pan)return"Please enter a valid pan number.";if(t.country=="India"&&!t.state)return"Please enter a valid state with correct spelling and the first letter capitalized.";const a=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Delhi","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"];if(t.country=="India"&&!a.includes(t.state))return"Please enter a valid state with correct spelling and the first letter capitalized.";console.log("validation address")},j=e=>{v.error(e.messages?.[0]||e)},x=e=>{t.country=e,r.reload()},M=D(()=>{if(o.type=="course")return`/lms/courses/${o.name}`;if(o.type=="batch")return`/lms/batches/${o.name}`;if(o.type=="certificate")return`/lms/courses/${o.name}/certification`});return E(()=>({title:__("Billing Details"),icon:g.favicon})),(e,a)=>(p(),b("div",J,[l("header",O,[d(n(G),{class:"h-7",items:[{label:e.__("Billing Details"),route:{name:"Billing"}}]},null,8,["items"])]),n(m).data?.access&&n(r).data?(p(),b("div",R,[l("div",W,[l("div",F,[l("div",Y,[l("div",Q,i(e.__("Payment for "))+" "+i(u.type)+": ",1),l("div",X,i(n(r).data.title),1)]),n(r).data.gst_applied?(p(),b("div",Z,[l("div",ee,i(e.__("Original Amount")),1),l("div",te,i(n(r).data.original_amount_formatted),1)])):_("",!0),n(r).data.gst_applied?(p(),b("div",ae,[l("div",se,i(e.__("GST Amount")),1),l("div",null,i(n(r).data.gst_amount_formatted),1)])):_("",!0),l("div",le,[l("div",ne,i(e.__("Total")),1),l("div",oe,i(n(r).data.total_amount_formatted),1)])]),l("div",ie,[l("div",re,[l("div",de,i(e.__("Address")),1)]),l("div",ue,[l("div",me,[d(n(c),{label:e.__("Billing Name"),modelValue:t.billing_name,"onUpdate:modelValue":a[0]||(a[0]=s=>t.billing_name=s)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Address Line 1"),modelValue:t.address_line1,"onUpdate:modelValue":a[1]||(a[1]=s=>t.address_line1=s)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Address Line 2"),modelValue:t.address_line2,"onUpdate:modelValue":a[2]||(a[2]=s=>t.address_line2=s)},null,8,["label","modelValue"]),d(n(c),{label:e.__("City"),modelValue:t.city,"onUpdate:modelValue":a[3]||(a[3]=s=>t.city=s)},null,8,["label","modelValue"]),d(n(c),{label:e.__("State"),modelValue:t.state,"onUpdate:modelValue":a[4]||(a[4]=s=>t.state=s)},null,8,["label","modelValue"])]),l("div",ce,[d(V,{doctype:"Country",value:t.country,onChange:a[5]||(a[5]=s=>x(s)),label:e.__("Country")},null,8,["value","label"]),d(n(c),{label:e.__("Postal Code"),modelValue:t.pincode,"onUpdate:modelValue":a[6]||(a[6]=s=>t.pincode=s)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Phone Number"),modelValue:t.phone,"onUpdate:modelValue":a[7]||(a[7]=s=>t.phone=s)},null,8,["label","modelValue"]),d(V,{doctype:"LMS Source",value:t.source,onChange:a[8]||(a[8]=s=>t.source=s),label:e.__("Where did you hear about us?")},null,8,["value","label"]),t.country=="India"?(p(),k(n(c),{key:0,label:e.__("GST Number"),modelValue:t.gstin,"onUpdate:modelValue":a[9]||(a[9]=s=>t.gstin=s)},null,8,["label","modelValue"])):_("",!0),t.country=="India"?(p(),k(n(c),{key:1,label:e.__("Pan Number"),modelValue:t.pan,"onUpdate:modelValue":a[10]||(a[10]=s=>t.pan=s)},null,8,["label","modelValue"])):_("",!0)])]),l("div",pe,[l("p",be,i(e.__("Make sure to enter the correct billing name as the same will be used in your invoice.")),1),d(n(L),{variant:"solid",size:"md",onClick:a[11]||(a[11]=s=>$())},{default:P(()=>[h(i(e.__("Proceed to Payment")),1)]),_:1})])])])])):n(m).data?.message?(p(),b("div",_e,[d(w,{text:n(m).data.message,buttonLabel:u.type=="course"?"Checkout Course":"Checkout Batch",buttonLink:u.type=="course"?`/lms/courses/${u.name}`:`/lms/batches/${u.name}`},null,8,["text","buttonLabel","buttonLink"])])):n(y).data?.name?_("",!0):(p(),b("div",ye,[d(w,{text:"Please login to access this page.",buttonLink:`/login?redirect-to=/lms/billing/${u.type}/${u.name}`},null,8,["buttonLink"])]))]))}};export{ze as default};
//# sourceMappingURL=Billing-BOGxyFDu.js.map
