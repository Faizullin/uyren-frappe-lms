{"version":3,"file":"ProgrammingExerciseSubmissions-f_-BfgkZ.js","sources":["../../../../frontend-monorepo/website/src/pages/ProgrammingExercises/ProgrammingExerciseSubmissions.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t</header>\n\t<div class=\"p-6\">\n\t\t<div class=\"flex items-center justify-between space-x-32 mb-5\">\n\t\t\t<div class=\"text-xl font-semibold text-ink-gray-7\">\n\t\t\t\t{{\n\t\t\t\t\tsubmissions.data?.length\n\t\t\t\t\t\t? __('{0} Submissions').format(submissions.data.length)\n\t\t\t\t\t\t: __('No Submissions')\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"submissions.data?.length\"\n\t\t\t\tclass=\"grid grid-cols-3 gap-5 flex-1\"\n\t\t\t>\n\t\t\t\t<Link\n\t\t\t\t\tdoctype=\"LMS Programming Exercise\"\n\t\t\t\t\tv-model=\"filters.exercise\"\n\t\t\t\t\t:placeholder=\"__('Filter by Exercise')\"\n\t\t\t\t/>\n\t\t\t\t<Link\n\t\t\t\t\tdoctype=\"User\"\n\t\t\t\t\tv-model=\"filters.member\"\n\t\t\t\t\t:placeholder=\"__('Filter by Member')\"\n\t\t\t\t\t:readonly=\"isStudent\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tv-model=\"filters.status\"\n\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t:options=\"[\n\t\t\t\t\t\t{ label: __(''), value: '' },\n\t\t\t\t\t\t{ label: __('Passed'), value: 'Passed' },\n\t\t\t\t\t\t{ label: __('Failed'), value: 'Failed' },\n\t\t\t\t\t]\"\n\t\t\t\t\t:placeholder=\"__('Filter by Status')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t\t<ListView\n\t\t\tv-if=\"submissions.loading || submissions.data?.length\"\n\t\t\t:columns=\"submissionColumns\"\n\t\t\t:rows=\"submissions.data\"\n\t\t\trowKey=\"name\"\n\t\t\t:options=\"{\n\t\t\t\tselectable: true,\n\t\t\t}\"\n\t\t>\n\t\t\t<ListHeader\n\t\t\t\tclass=\"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2\"\n\t\t\t>\n\t\t\t\t<ListHeaderItem\n\t\t\t\t\t:item=\"item\"\n\t\t\t\t\tv-for=\"item in submissionColumns\"\n\t\t\t\t\t:key=\"item.key\"\n\t\t\t\t>\n\t\t\t\t\t<template #prefix=\"{ item }\">\n\t\t\t\t\t\t<FeatherIcon :name=\"item.icon?.toString()\" class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t</ListHeaderItem>\n\t\t\t</ListHeader>\n\t\t\t<ListRows>\n\t\t\t\t<router-link\n\t\t\t\t\tv-for=\"row in submissions.data\"\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'ProgrammingExerciseSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\texerciseID: row.exercise,\n\t\t\t\t\t\t\tsubmissionID: row.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<ListRow :row=\"row\">\n\t\t\t\t\t\t<template #default=\"{ column, item }\">\n\t\t\t\t\t\t\t<ListRowItem :item=\"row[column.key]\" :align=\"column.align\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<div v-if=\"column.key == 'member_name'\">\n\t\t\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\t\t\tclass=\"flex items-center\"\n\t\t\t\t\t\t\t\t\t\t\t:image=\"row['member_image']\"\n\t\t\t\t\t\t\t\t\t\t\t:label=\"item\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<div v-if=\"column.key == 'status'\">\n\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t:theme=\"row[column.key] === 'Passed' ? 'green' : 'red'\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</ListRowItem>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</ListRow>\n\t\t\t\t</router-link>\n\t\t\t</ListRows>\n\t\t\t<ListSelectBanner>\n\t\t\t\t<template #actions=\"{ unselectAll, selections }\">\n\t\t\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t@click=\"deleteExercises(selections, unselectAll)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Trash2 class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</ListSelectBanner>\n\t\t</ListView>\n\t\t<EmptyState v-else type=\"Programming Exercise Submissions\" />\n\t\t<div\n\t\t\tv-if=\"submissions.data && submissions.hasNextPage\"\n\t\t\tclass=\"flex justify-center my-5\"\n\t\t>\n\t\t\t<Button @click=\"submissions.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup lang=\"ts\">\nimport {\n\tAvatar,\n\tBadge,\n\tBreadcrumbs,\n\tButton,\n\tcreateListResource,\n\tFeatherIcon,\n\tFormControl,\n\tListView,\n\tListHeader,\n\tListHeaderItem,\n\tListRows,\n\tListRow,\n\tListRowItem,\n\tListSelectBanner,\n\tusePageMeta,\n\ttoast,\n} from '@mono/mono-frappe-ui'\nimport type {\n\tProgrammingExerciseSubmission,\n\tFilters,\n} from '@/pages/ProgrammingExercises/types'\nimport { computed, inject, onMounted, ref, watch } from 'vue'\nimport { sessionStore } from '@/stores/session'\nimport { useRouter } from 'vue-router'\nimport { Trash2 } from 'lucide-vue-next'\nimport Link from '@/components/Controls/Link.vue'\nimport EmptyState from '@/components/EmptyState.vue'\n\nconst { brand } = sessionStore()\nconst dayjs = inject('$dayjs') as any\nconst user = inject('$user') as any\nconst filterFields = ['exercise', 'member', 'status']\nconst filters = ref<Filters>({\n\texercise: '',\n\tmember: '',\n\tstatus: '',\n})\nconst router = useRouter()\n\nonMounted(() => {\n\tsetFiltersFromRoute()\n\tfetchBasedOnRole()\n})\n\nconst setFiltersFromRoute = () => {\n\tfilterFields.forEach((field) => {\n\t\tif (router.currentRoute.value.query[field]) {\n\t\t\tfilters.value[field as keyof Filters] = router.currentRoute.value.query[\n\t\t\t\tfield\n\t\t\t] as string\n\t\t}\n\t})\n}\n\nconst fetchBasedOnRole = () => {\n\tif (isStudent.value) {\n\t\tfilters.value['member'] = user.data?.name\n\t} else {\n\t\tsubmissions.reload()\n\t}\n}\n\nconst submissions = createListResource({\n\tdoctype: 'LMS Programming Exercise Submission',\n\tfields: [\n\t\t'name',\n\t\t'exercise',\n\t\t'exercise_title',\n\t\t'member_name',\n\t\t'member_image',\n\t\t'status',\n\t\t'modified',\n\t],\n\torderBy: 'modified desc',\n\ttransform(data: ProgrammingExercise[]) {\n\t\treturn data.map((submission: ProgrammingExerciseSubmission) => {\n\t\t\treturn {\n\t\t\t\t...submission,\n\t\t\t\tmodified: dayjs(submission.modified).fromNow(),\n\t\t\t}\n\t\t})\n\t},\n})\n\nwatch(filters.value, () => {\n\tlet filtersToApply: Record<string, any> = {}\n\tfilterFields.forEach((field) => {\n\t\tif (filters.value[field as keyof Filters]) {\n\t\t\tfiltersToApply[field] = filters.value[field as keyof Filters]\n\t\t\trouter.push({\n\t\t\t\tquery: {\n\t\t\t\t\t...router.currentRoute.value.query,\n\t\t\t\t\t[field]: filters.value[field as keyof Filters],\n\t\t\t\t},\n\t\t\t})\n\t\t} else {\n\t\t\tdelete filtersToApply[field]\n\t\t\tconst query = { ...router.currentRoute.value.query }\n\t\t\tdelete query[field]\n\t\t\trouter.push({\n\t\t\t\tquery,\n\t\t\t})\n\t\t}\n\t})\n\n\tsubmissions.update({\n\t\tfilters: {\n\t\t\t...filtersToApply,\n\t\t},\n\t})\n\tsubmissions.reload()\n})\n\nconst deleteExercises = (selections: Set<string>, unselectAll: () => void) => {\n\tArray.from(selections).forEach(async (submission: string) => {\n\t\tawait submissions.delete.submit(submission)\n\t})\n\tunselectAll()\n\ttoast.success(__('Submissions deleted successfully'))\n}\n\nconst isStudent = computed(() => {\n\treturn (\n\t\t!user.data?.is_instructor &&\n\t\t!user.data?.is_moderator &&\n\t\t!user.data?.is_evaluator\n\t)\n})\n\nconst submissionColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Member'),\n\t\t\tkey: 'member_name',\n\t\t\twidth: '20%',\n\t\t\ticon: 'user',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Exercise'),\n\t\t\tkey: 'exercise_title',\n\t\t\twidth: '30%',\n\t\t\ticon: 'code',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Status'),\n\t\t\tkey: 'status',\n\t\t\twidth: '20%',\n\t\t\ticon: 'check-circle',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Modified'),\n\t\t\tkey: 'modified',\n\t\t\twidth: '20%',\n\t\t\ticon: 'clock',\n\t\t\talign: 'right',\n\t\t},\n\t]\n})\n\nconst breadcrumbs = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Programming Exercise Submissions'),\n\t\t\troute: {\n\t\t\t\tname: 'ProgrammingExerciseSubmissions',\n\t\t\t},\n\t\t},\n\t]\n})\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Programming Exercises'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n"],"names":["brand","sessionStore","dayjs","inject","user","filterFields","filters","ref","router","useRouter","onMounted","setFiltersFromRoute","fetchBasedOnRole","field","isStudent","submissions","createListResource","data","submission","watch","filtersToApply","query","deleteExercises","selections","unselectAll","toast","computed","submissionColumns","breadcrumbs","usePageMeta","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","__","_openBlock","_createElementBlock","_hoisted_5","Link","_cache","$event","FormControl","_createBlock","ListView","ListHeader","_Fragment","_renderList","item","ListHeaderItem","_withCtx","FeatherIcon","ListRows","row","_component_router_link","ListRow","column","ListRowItem","_hoisted_6","Avatar","_hoisted_7","Badge","_hoisted_8","ListSelectBanner","_hoisted_9","Button","Trash2","EmptyState","_hoisted_10"],"mappings":"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"}