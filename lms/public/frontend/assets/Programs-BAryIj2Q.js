import{x as z,i as F,g as P,u as D,dg as E,y as q,I as R,q as T,a as U,r as I,c as o,o as s,d as f,B as d,b as u,h as c,s as a,w as i,e as g,t as m,P as J,D as w,F as k,f as C,J as x,bC as K,a3 as O,E as A,V as G,l as V,N as H}from"./index-CgbsATbs.js";import{_ as Q}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-KbxUUXyD.js";import{_ as W}from"./CourseCard-_rlp9Urb.js";import{_ as X}from"./EmptyState.vue_vue_type_script_setup_true_lang-DGwjDck2.js";import"./UserAvatar-ChxEkYoI.js";import"./CourseInstructors-DuPIVzgx.js";import"./ProgressBar-DXZfku_t.js";const Y={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},Z={key:0,class:"pt-5 px-5"},ee={class:"mb-10"},se={class:"flex items-center justify-between"},te={class:"text-xl text-ink-gray-9 font-semibold"},ae={class:"flex items-center space-x-2"},re={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mt-5"},oe={class:"relative group"},ne={key:0,class:"absolute inset-0 bg-black-overlay-500 opacity-60 rounded-md"},le={key:1,class:"absolute inset-0 flex items-center justify-center"},ie={key:1,class:"text-sm italic text-ink-gray-5 mt-4"},he={__name:"Programs",setup(me){const{brand:$}=z(),l=F("$user"),b=P(!1),_=D(),h=P(""),B=E(),y=window.read_only_mode;q(()=>{!B.learningPaths.data&&!l.data?.is_moderator&&!l.data?.is_instructor&&_.push({name:"Courses"})});const v=R({url:"lms.lms.utils.get_programs",auto:!0,cache:"programs"}),L=e=>{V("frappe.client.insert",{doc:{doctype:"LMS Program",title:h.value}}).then(r=>{_.push({name:"ProgramForm",params:{programName:r.name}})})},M=(e,r)=>{V("lms.lms.utils.enroll_in_program_course",{program:e,course:r}).then(n=>{n.current_lesson?_.push({name:"Lesson",params:{courseName:r,chapterNumber:n.current_lesson.split("-")[0],lessonNumber:n.current_lesson.split("-")[1]}}):n&&_.push({name:"Lesson",params:{courseName:r,chapterNumber:1,lessonNumber:1}})}).catch(n=>{H.error(n.messages?.[0]||n)})},N=e=>!(l.data?.is_moderator||l.data?.is_instructor||e.membership||e.eligible),S=()=>y?!1:!!(l.data?.is_moderator||l.data?.is_instructor),j=T(()=>[{label:__("Programs")}]);return U(()=>({title:__("Programs"),icon:$.favicon})),(e,r)=>{const n=I("router-link");return s(),o(k,null,[f("header",Y,[u(a(Q),{items:j.value},null,8,["items"]),S()?(s(),d(a(w),{key:0,onClick:r[0]||(r[0]=t=>b.value=!0),variant:"solid"},{prefix:i(()=>[u(a(J),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[g(" "+m(e.__("New")),1)]),_:1})):c("",!0)]),a(v).data?.length?(s(),o("div",Z,[(s(!0),o(k,null,C(a(v).data,t=>(s(),o("div",ee,[f("div",se,[f("div",te,m(t.name),1),f("div",ae,[t.members?(s(),d(a(x),{key:0,variant:"subtle",theme:"green",size:"lg"},{default:i(()=>[g(m(t.members)+" "+m(t.members==1?e.__("member"):e.__("members")),1)]),_:2},1024)):c("",!0),t.progress?(s(),d(a(x),{key:1,variant:"subtle",theme:"blue",size:"lg"},{default:i(()=>[g(m(t.progress)+m(e.__("% completed")),1)]),_:2},1024)):c("",!0),a(l).data?.is_moderator||a(l).data?.is_instructor?(s(),d(n,{key:2,to:{name:"ProgramForm",params:{programName:t.name}}},{default:i(()=>[a(y)?c("",!0):(s(),d(a(w),{key:0},{prefix:i(()=>[u(a(K),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[g(" "+m(e.__("Edit")),1)]),_:1}))]),_:2},1032,["to"])):c("",!0)])]),t.courses?.length?(s(),o("div",re,[(s(!0),o(k,null,C(t.courses,p=>(s(),o("div",oe,[u(W,{course:p,onClick:ue=>M(t.name,p.name),class:"cursor-pointer"},null,8,["course","onClick"]),N(p)?(s(),o("div",ne)):c("",!0),N(p)?(s(),o("div",le,[u(a(O),{class:"size-10 text-ink-white"})])):c("",!0)]))),256))])):(s(),o("div",ie,m(e.__("No courses in this program")),1))]))),256))])):(s(),d(X,{key:1,type:"Programs"})),u(a(G),{modelValue:b.value,"onUpdate:modelValue":r[2]||(r[2]=t=>b.value=t),options:{title:e.__("New Program"),actions:[{label:e.__("Create"),variant:"solid",onClick:()=>L(e.close)}]}},{"body-content":i(()=>[u(a(A),{label:e.__("Title"),modelValue:h.value,"onUpdate:modelValue":r[1]||(r[1]=t=>h.value=t)},null,8,["label","modelValue"])]),_:1},8,["modelValue","options"])],64)}}};export{he as default};
//# sourceMappingURL=Programs-BAryIj2Q.js.map
