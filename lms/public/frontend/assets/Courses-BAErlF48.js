import{z as C,c as v,o as n,F as L,f as M,q as Z,t as w,i as U,g as c,B as ee,n as te,C as le,l as E,D as ae,a as se,r as oe,d as g,b as f,E as h,h as x,p as o,G as re,w as y,H as N,e as P,P as ne,I as j,J as ue,K as ie}from"./index-RevCnO16.js";import{_ as de}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CeasAM64.js";import{_ as ce}from"./CourseCard-s1LchMm6.js";import{_ as pe}from"./EmptyState.vue_vue_type_script_setup_true_lang-6vpbuXAr.js";import"./UserAvatar-6CYw18x4.js";import"./CourseInstructors-DpcoSywQ.js";import"./ProgressBar-D6f4tpmc.js";const me={class:"bg-gray-100 p-1 rounded-full flex flex-wrap gap-2 sm:w-fit sm:flex-nowrap sm:overflow-x-auto sm:scrollbar-hide"},fe=["onClick"],ve={__name:"CustomTabButtons",props:{buttons:Array,modelValue:String},emits:["update:modelValue"],setup(V,{emit:s}){const k=V,$=s,S=C(()=>k.modelValue),p=d=>{$("update:modelValue",d)};return(d,_)=>(n(),v("div",me,[(n(!0),v(L,null,M(V.buttons,u=>(n(),v("button",{key:u.label,onClick:l=>p(u.label),class:Z(["px-5 py-3 rounded-full text-md font-medium transition-colors duration-200 whitespace-nowrap",S.value===u.label?"bg-[#f1511b] text-white shadow-sm":"bg-transparent text-[#f1511b] hover:bg-[#f1511b]/10"])},w(u.label),11,fe))),128))]))}},_e={class:"sticky flex items-center justify-between top-0 z-10 border-[#E4E4E4] border-b-[2.5px] bg-surface-white px-3 py-[24px] sm:px-5"},ge={class:"p-5 pb-10"},be={class:"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:items-center justify-between mb-5"},xe={key:0,class:"hidden xl:block text-xl text-ink-gray-9 font-semibold"},ye={class:"flex flex-col xl:flex-row space-y-4 xl:space-y-0 xl:items-center justify-between mb-5"},he={class:"flex flex-col md:flex-row md:items-center md:space-x-4 space-y-4 md:space-y-0"},Ce={class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40"},we={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-4"},Ve={key:2,class:"flex justify-center mt-5"},Ne={__name:"Courses",setup(V){const s=U("$user"),k=U("$dayjs"),$=c(0),S=c(30),p=c([]),d=c(null),_=c(""),u=c(!1),l=c({}),i=c("Live"),{brand:T}=ee(),F=c(0);te(()=>{B(),b(),Y(),p.value=[{label:"",value:null}]});const z=C(()=>s?.data?.is_system_manager||s?.data?.role==="Administrator"),B=()=>{let e=new URLSearchParams(location.search);_.value=e.get("title")||"",d.value=e.get("category")||null,u.value=e.get("certification")||!1},m=le({doctype:"LMS Course",url:"lms.lms.utils.get_courses",cache:["courses",s.data?.name],pageLength:S.value,start:$.value,onSuccess(e){D(e)}}),D=e=>{let t=e.map(r=>r.category);t=t.filter((r,a)=>t.indexOf(r)===a&&r),p.value.length<=t.length&&J(e)},q=async()=>await E("frappe.client.get_single_value",{doctype:"LMS Settings",field:"persona_captured"}),A=async()=>{if(s.data?.is_system_manager&&!s.data?.developer_mode){if(await q())return;F.value||ie.push({name:"PersonaForm"})}},Y=()=>{s.data&&E("frappe.client.get_count",{doctype:"LMS Course"}).then(e=>{F.value=e,A()})},b=()=>{R(),m.update({filters:l.value}),m.reload()},R=()=>{I(),K(),O(),Q(),G(),H()},I=()=>{d.value?l.value.category=d.value:delete l.value.category},K=()=>{_.value?l.value.title=["like",`%${_.value}%`]:delete l.value.title},O=()=>{u.value?l.value.certification=1:delete l.value.certification},Q=()=>{delete l.value.live,delete l.value.created,delete l.value.published_on,delete l.value.upcoming,i.value=="Enrolled"&&s.data?.is_student?(l.value.enrolled=1,delete l.value.published):(delete l.value.published,delete l.value.enrolled,i.value=="Live"?(l.value.published=1,l.value.upcoming=0,l.value.live=1):i.value=="Upcoming"?l.value.upcoming=1:i.value=="New"?(l.value.published=1,l.value.published_on=[">=",k().add(-3,"month").format("YYYY-MM-DD")]):i.value=="Created"?l.value.created=1:i.value=="Unpublished"&&(l.value.published=0))},G=()=>{(!s.data||s.data?.is_student&&i.value!="Enrolled")&&(l.value.published=1)},H=()=>{let e=new URLSearchParams(location.search),t={title:_.value,category:d.value,certification:u.value};Object.keys(t).forEach(a=>{t[a]?e.set(a,t[a]):e.delete(a)});let r="";e.toString()&&(r=`?${e.toString()}`),history.replaceState({},"",`${location.pathname}${r}`)},J=e=>{e.forEach(t=>{t.category&&!p.value.find(r=>r.value===t.category)&&p.value.push({label:t.category,value:t.category})})};ae(i,()=>{b()});const W=C(()=>{let e=[{label:__("Live")},{label:__("New")},{label:__("Upcoming")}];return s.data?.is_moderator||s.data?.is_instructor||s.data?.is_evaluator?(e.push({label:__("Created")}),e.push({label:__("Unpublished")})):s.data&&e.push({label:__("Enrolled")}),e}),X=C(()=>[{label:__("Courses"),route:{name:"Courses"}}]);return se(()=>({title:__("Courses"),icon:T.favicon})),(e,t)=>{const r=oe("router-link");return n(),v(L,null,[g("header",_e,[f(o(de),{class:"text-3xl font-semibold text-neutral-900",items:X.value},null,8,["items"]),o(re)()?(n(),h(r,{key:0,to:{name:"CourseForm",params:{courseName:"new"}}},{default:y(()=>[f(o(N),{class:"xl py-4 px-5 text-lg font-semibold rounded-lg",variant:"solid",style:{"background-color":"rgb(241, 81, 27)"}},{prefix:y(()=>[f(o(ne),{class:"h-6 w-6 stroke-2"})]),default:y(()=>[P(" "+w(e.__("New")),1)]),_:1})]),_:1})):x("",!0)]),g("div",ge,[g("div",be,[z.value?x("",!0):(n(),v("div",xe,w(e.__("All Courses")),1)),g("div",ye,[f(ve,{buttons:W.value,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value=a)},null,8,["buttons","modelValue"]),g("div",he,[f(o(j),{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=a=>u.value=a),label:e.__("Certification"),type:"checkbox",size:"2xl",class:"p-[10px] text-[18px]",onChange:t[2]||(t[2]=a=>b())},null,8,["modelValue","label"]),f(o(j),{modelValue:_.value,"onUpdate:modelValue":t[3]||(t[3]=a=>_.value=a),placeholder:e.__("Search by Title"),type:"text",size:"xl",variant:"outline",class:"md:w-[200px] lg:w-[200px] xl:w-[200px] max-w-full text-[#f1511b]",onInput:t[4]||(t[4]=a=>b())},null,8,["modelValue","placeholder"]),g("div",Ce,[p.value.length?(n(),h(o(ue),{key:0,modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=a=>d.value=a),options:p.value,placeholder:e.__("Category"),size:"xl",variant:"outline",onChange:t[6]||(t[6]=a=>b())},null,8,["modelValue","options","placeholder"])):x("",!0)])])])]),o(m).data?.length?(n(),v("div",we,[(n(!0),v(L,null,M(o(m).data,a=>(n(),h(r,{to:{name:"CourseDetail",params:{courseName:a.name}}},{default:y(()=>[f(ce,{course:a},null,8,["course"])]),_:2},1032,["to"]))),256))])):o(m).list.loading?x("",!0):(n(),h(pe,{key:1,type:"Courses"})),!o(m).list.loading&&o(m).hasNextPage?(n(),v("div",Ve,[f(o(N),{onClick:t[7]||(t[7]=a=>o(m).next())},{default:y(()=>[P(w(e.__("Load More")),1)]),_:1})])):x("",!0)])],64)}}};export{Ne as default};
//# sourceMappingURL=Courses-BAErlF48.js.map
