import{B as M,a9 as N,i as w,g as E,ak as G,al as $,C as x,L as y,z as P,a as T,c as l,o as u,d as n,h as V,b as _,p as a,t as S,w as D,e as R,H as B,F as I,l as k}from"./index-RevCnO16.js";import{_ as z}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CeasAM64.js";const F={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},A={key:0},j=["src"],q={key:1},O={class:"text-center pt-10 px-5 md:px-0 pb-10"},H={class:"text-center"},Y={class:"mb-4"},U={__name:"SCORMChapter",props:{courseName:{type:String,required:!0},chapterName:{type:String,required:!0}},setup(h){const{brand:f}=M(),g=N(),o=w("$user"),i=E(!1),r=h;G(()=>{g.isSidebarCollapsed=!0,L()});const t=$({doctype:"Course Chapter",name:r.chapterName,auto:!0,cache:["chapter",r.chapterName],onSuccess(e){p.submit()}}),c=x({doctype:"LMS Enrollment",fields:["member","course"],filters:{course:r.courseName,member:o.data?.name},auto:!0,cache:["enrollments",r.courseName,o.data?.name]}),m=e=>e=="cmi.core.lesson_status"?p.data?.status=="Complete"?"passed":"incomplete":"",d=(e,s)=>{e=="cmi.core.lesson_status"&&s=="passed"&&b()},b=()=>{k("lms.lms.doctype.course_lesson.course_lesson.save_progress",{lesson:t.doc.lessons[0].lesson,course:r.courseName})},p=y({url:"frappe.client.get_value",makeParams(e){return{doctype:"LMS Course Progress",fieldname:"status",filters:{member:o.data?.name,lesson:t.doc.lessons[0].lesson,chapter:t.doc.name,course:t.doc?.course}}},onSuccess(e){i.value=!0}}),C=()=>{c.insert.submit({course:r.courseName,member:o.data?.name},{onSuccess(e){window.location.reload()}})},L=()=>{window.API_1484_11={Initialize:()=>"true",Terminate:()=>"true",GetValue:e=>(console.log(`GET: ${e}`),m(e)),SetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),d(e,s),"true"),Commit:()=>"true",GetLastError:()=>"0",GetErrorString:()=>"",GetDiagnostic:()=>""},window.API={LMSInitialize:()=>"true",LMSFinish:()=>"true",LMSGetValue:e=>(console.log(`GET: ${e}`),m(e)),LMSSetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),d(e,s),"true"),LMSCommit:()=>"true",LMSGetLastError:()=>"0",LMSGetErrorString:()=>"",LMSGetDiagnostic:()=>""}},v=P(()=>[{label:"Courses",route:{name:"Courses"}},{label:t.doc?.course_title,route:{name:"CourseDetail",params:{courseName:r.courseName}}},{label:t.doc?.title}]);return T(()=>({title:t.doc?.title,icon:f.favicon})),(e,s)=>(u(),l(I,null,[n("header",F,[_(a(z),{class:"h-7",items:v.value},null,8,["items"])]),i.value&&(a(c).data?.length||a(o).data?.is_moderator||a(o).data?.is_instructor)?(u(),l("div",A,[n("iframe",{src:a(t).doc.launch_file,class:"w-full h-screen"},null,8,j)])):a(c).data?.length?V("",!0):(u(),l("div",q,[n("div",O,[n("div",H,[n("div",Y,S(e.__("You are not enrolled in this course. Please enroll to access this lesson.")),1),_(a(B),{variant:"solid",onClick:s[0]||(s[0]=J=>C())},{default:D(()=>[R(S(e.__("Start Learning")),1)]),_:1})])])]))],64))}};export{U as default};
//# sourceMappingURL=SCORMChapter-BUB3z6Fv.js.map
