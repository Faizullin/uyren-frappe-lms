import"@headlessui/vue";import{e as c,f as r,g as n,k as f,t as u,p as D,h as m,l as o,a6 as W,a7 as F,a8 as X,F as Y,x as j,j as y,C as Z,i as M,s as ee,r as v,b as S,o as te,c as ae,w as le,u as se,d as oe,n as w,_ as U,P as re,q as L,v as ie}from"./index-BIerRe8o.js";import{_ as ne}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Cdx-1Hlv.js";import{T as ue}from"./TabButtons-DGauTnEB.js";import"@tiptap/extension-code-block-lowlight";import"@tiptap/extension-placeholder";import"@tiptap/extension-table";import"@tiptap/extension-table-cell";import"@tiptap/extension-table-header";import"@tiptap/extension-table-row";import"@tiptap/extension-text-align";import"@tiptap/extension-text-style";import"@tiptap/extension-typography";import"@tiptap/vue-3";import"@tiptap/extension-mention";import"@vueuse/core";import{_ as ce}from"./DateRange-DkjHGnF_.js";import{_ as de}from"./CourseInstructors-B6EFgXV2.js";import{_ as me}from"./UserAvatar-D66_PbG8.js";import{_ as fe}from"./EmptyState.vue_vue_type_script_setup_true_lang-CbCenUow.js";import"@tiptap/core";import"@tiptap/extension-code-block";import"@tiptap/extension-heading";import"@tiptap/suggestion";import"@tiptap/extension-link";const ve={class:"flex flex-col border hover:border-outline-gray-3 rounded-md p-4 h-full",style:{"min-height":"150px"}},he={class:"text-lg leading-5 font-semibold mb-2 text-ink-gray-9"},ge={key:0,class:"text-xs bg-green-100 text-green-700 self-start px-2 py-0.5 rounded-md"},_e={key:0},pe={key:1},be={key:1,class:"text-xs bg-red-100 text-red-700 self-start px-2 py-0.5 rounded-md"},ye={class:"short-introduction text-sm text-ink-gray-7"},xe={key:2,class:"font-semibold text-ink-gray-9 mb-4"},ke={class:"flex flex-col space-y-2 mt-auto"},$e={class:"flex items-center text-sm text-ink-gray-7"},we={key:0,class:"flex items-center text-sm text-ink-gray-7"},Be={key:3,class:"flex avatar-group overlap mt-4"},Ce={__name:"BatchCard",props:{batch:{type:Object,default:null}},setup(a){return(i,B)=>(r(),c("div",ve,[n("div",he,u(a.batch.title),1),a.batch.seat_count&&a.batch.seats_left>0?(r(),c("div",ge,[D(u(a.batch.seats_left)+" ",1),a.batch.seats_left>1?(r(),c("span",_e,u(i.__("Seats Left")),1)):a.batch.seats_left==1?(r(),c("span",pe,u(i.__("Seat Left")),1)):f("",!0)])):a.batch.seat_count&&a.batch.seats_left<=0?(r(),c("div",be,u(i.__("Sold Out")),1)):f("",!0),n("div",ye,u(a.batch.description),1),a.batch.amount?(r(),c("div",xe,u(a.batch.price),1)):f("",!0),n("div",ke,[m(ce,{startDate:a.batch.start_date,endDate:a.batch.end_date,class:"text-sm text-ink-gray-7"},null,8,["startDate","endDate"]),n("div",$e,[m(o(W),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-7"}),n("span",null,u(o(F)(a.batch.start_time))+" - "+u(o(F)(a.batch.end_time)),1)]),a.batch.timezone?(r(),c("div",we,[m(o(X),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-5"}),n("span",null,u(a.batch.timezone),1)])):f("",!0)]),a.batch.instructors?.length?(r(),c("div",Be,[n("div",{class:Z(["h-6 mr-1",{"avatar-group overlap":a.batch.instructors.length>1}])},[(r(!0),c(Y,null,j(a.batch.instructors,V=>(r(),y(me,{user:V},null,8,["user"]))),256))],2),m(de,{instructors:a.batch.instructors},null,8,["instructors"])])):f("",!0)]))}},Ve={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},Se={class:"p-5 pb-10"},De={class:"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:items-center justify-between mb-5"},Ye={class:"text-lg text-ink-gray-9 font-semibold"},Fe={class:"flex flex-col space-y-2 lg:space-y-0 lg:flex-row lg:items-center lg:space-x-4"},Me={class:"grid grid-cols-2 gap-2"},Ue={class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40"},Le={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5"},je={key:2,class:"flex justify-center mt-5"},it={__name:"Batches",setup(a){const i=M("$user"),B=M("$dayjs"),{brand:V}=ee(),T=v(0),N=v(20),_=v([]),p=v(null),b=v(""),x=v(!1),s=v({}),C=S(()=>i.data?.is_student),h=v(C.value?"All":"Upcoming"),k=v("start_date"),P=window.read_only_mode;te(()=>{E(),$(),_.value=[{label:"",value:null}]});const E=()=>{let t=new URLSearchParams(location.search);b.value=t.get("title")||"",p.value=t.get("category")||null,x.value=t.get("certification")||!1},g=ae({doctype:"LMS Batch",url:"lms.lms.utils.get_batches",cache:["batches",i.data?.name],pageLength:N.value,start:T.value,onSuccess(t){let e=t.map(d=>d.category);e=e.filter((d,l)=>e.indexOf(d)===l&&d),_.value.length<=e.length&&I(t)}}),$=()=>{A(),g.update({filters:s.value,orderBy:k.value}),g.reload()},A=()=>{O(),q(),z(),R(),Q(),G()},O=()=>{p.value?s.value.category=p.value:delete s.value.category},q=()=>{b.value?s.value.title=["like",`%${b.value}%`]:delete s.value.title},z=()=>{x.value?s.value.certification=1:delete s.value.certification},R=()=>{k.value="start_date",i.data&&(h.value=="Enrolled"&&C.value?(s.value.enrolled=1,delete s.value.start_date,delete s.value.published,k.value="start_date desc"):C.value?delete s.value.enrolled:(delete s.value.start_date,delete s.value.published,k.value="start_date desc",h.value=="Upcoming"?(s.value.start_date=[">=",B().format("YYYY-MM-DD")],s.value.published=1,k.value="start_date"):h.value=="Archived"?s.value.start_date=["<=",B().format("YYYY-MM-DD")]:h.value=="Unpublished"&&(s.value.published=0)))},Q=()=>{(!i.data||C.value&&h.value!="Enrolled")&&(s.value.start_date=[">=",B().format("YYYY-MM-DD")],s.value.published=1)},G=()=>{let t=new URLSearchParams(location.search),e={title:b.value,category:p.value,certification:x.value};Object.keys(e).forEach(l=>{e[l]?t.set(l,e[l]):t.delete(l)});let d="";t.toString()&&(d=`?${t.toString()}`),history.replaceState({},"",`${location.pathname}${d}`)},I=t=>{t.forEach(e=>{e.category&&!_.value.find(d=>d.value===e.category)&&_.value.push({label:e.category,value:e.category})})};le(h,()=>{$()});const K=S(()=>{let t=[{label:__("All")}];return i.data?.is_moderator||i.data?.is_instructor||i.data?.is_evaluator?(t.push({label:__("Upcoming")}),t.push({label:__("Archived")}),t.push({label:__("Unpublished")})):i.data&&t.push({label:__("Enrolled")}),t}),H=()=>P?!1:!!(i.data?.is_moderator||i.data?.is_instructor),J=S(()=>[{label:__("Batches"),route:{name:"Batches"}}]);return se(()=>({title:__("Batches"),icon:V.favicon})),(t,e)=>{const d=oe("router-link");return r(),c(Y,null,[n("header",Ve,[m(o(ne),{items:J.value},null,8,["items"]),H()?(r(),y(d,{key:0,to:{name:"BatchForm",params:{batchName:"new"}}},{default:w(()=>[m(o(U),{variant:"solid"},{prefix:w(()=>[m(o(re),{class:"h-4 w-4 stroke-1.5"})]),default:w(()=>[D(" "+u(t.__("New")),1)]),_:1})]),_:1})):f("",!0)]),n("div",Se,[n("div",De,[n("div",Ye,u(t.__("All Batches")),1),n("div",Fe,[o(i).data?(r(),y(o(ue),{key:0,buttons:K.value,modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=l=>h.value=l)},null,8,["buttons","modelValue"])):f("",!0),m(o(L),{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=l=>x.value=l),label:t.__("Certification"),type:"checkbox",onChange:e[2]||(e[2]=l=>$())},null,8,["modelValue","label"]),n("div",Me,[m(o(L),{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=l=>b.value=l),placeholder:t.__("Search by Title"),type:"text",class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40",onInput:e[4]||(e[4]=l=>$())},null,8,["modelValue","placeholder"]),n("div",Ue,[_.value.length?(r(),y(o(ie),{key:0,modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=l=>p.value=l),options:_.value,placeholder:t.__("Category"),onChange:e[6]||(e[6]=l=>$())},null,8,["modelValue","options","placeholder"])):f("",!0)])])])]),o(g).data?.length?(r(),c("div",Le,[(r(!0),c(Y,null,j(o(g).data,l=>(r(),y(d,{to:{name:"BatchDetail",params:{batchName:l.name}}},{default:w(()=>[m(Ce,{batch:l},null,8,["batch"])]),_:2},1032,["to"]))),256))])):o(g).list.loading?f("",!0):(r(),y(fe,{key:1,type:"Batches"})),!o(g).list.loading&&o(g).hasNextPage?(r(),c("div",je,[m(o(U),{onClick:e[7]||(e[7]=l=>o(g).next())},{default:w(()=>[D(u(t.__("Load More")),1)]),_:1})])):f("",!0)])],64)}}};export{it as default};
//# sourceMappingURL=Batches-CzGJ1Dnf.js.map
