import{az as j,Q as P,R as I,T as B,A as T,q as V,r as z,B as x,o as g,w as f,d,t as v,b as u,s as e,E as C,e as A,aL as E,h,D as $,V as O,N as q,i as S,g as k,x as Q,u as W,y as G,z as H,l as J,a as K,c as D,P as X,at as Y,W as Z,F as ee}from"./index-CgbsATbs.js";import{_ as se}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-KbxUUXyD.js";import{_ as te}from"./EmptyState.vue_vue_type_script_setup_true_lang-DGwjDck2.js";const ne={class:"p-5 text-base"},ae={class:"text-lg text-ink-gray-9 font-semibold mb-5"},le={class:"space-y-4 max-h-[75vh] overflow-y-auto"},oe={class:"text-xs text-ink-gray-5 mb-2"},ie={class:"flex justify-end space-x-2 mt-5"},ue=j({__name:"AssignmentForm",props:P({assignmentID:{type:String,default:"new"}},{modelValue:{},modelModifiers:{},assignments:{},assignmentsModifiers:{}}),emits:["update:modelValue","update:assignments"],setup(p){const c=I(p,"modelValue"),b=I(p,"assignments"),s=B({title:"",type:"",question:""}),o=p;T(()=>o.assignmentID,a=>{a!=="new"&&b.value?.data.forEach(n=>{n.name===a&&(s.title=n.title,s.type=n.type,s.question=n.question)})},{flush:"post"});const y=()=>{o.assignmentID=="new"?b.value.insert.submit({...s},{onSuccess(){c.value=!1,q.success(__("Assignment created successfully"))}}):b.value.setValue.submit({...s,name:o.assignmentID},{onSuccess(){c.value=!1,q.success(__("Assignment updated successfully"))}})},w=V(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(a,n)=>{const _=z("router-link");return g(),x(e(O),{modelValue:c.value,"onUpdate:modelValue":n[3]||(n[3]=r=>c.value=r),options:{size:"lg"}},{body:f(()=>[d("div",ne,[d("div",ae,v(p.assignmentID==="new"?a.__("Create an Assignment"):a.__("Edit Assignment")),1),d("div",le,[u(e(C),{modelValue:s.title,"onUpdate:modelValue":n[0]||(n[0]=r=>s.title=r),label:a.__("Title"),required:!0},null,8,["modelValue","label"]),u(e(C),{modelValue:s.type,"onUpdate:modelValue":n[1]||(n[1]=r=>s.type=r),type:"select",options:w.value,label:a.__("Submission Type"),required:!0},null,8,["modelValue","options","label"]),d("div",null,[d("div",oe,[A(v(a.__("Question"))+" ",1),n[4]||(n[4]=d("span",{class:"text-ink-red-3"},"*",-1))]),u(e(E),{content:s.question,onChange:n[2]||(n[2]=r=>s.question=r),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[18rem] overflow-y-auto"},null,8,["content"])])]),d("div",ie,[u(_,{to:{name:"AssignmentSubmissionList",query:{assignmentID:p.assignmentID}}},{default:f(()=>[p.assignmentID!=="new"?(g(),x(e($),{key:0,variant:"subtle"},{default:f(()=>[A(v(a.__("Check Submissions")),1)]),_:1})):h("",!0)]),_:1},8,["to"]),u(e($),{variant:"solid",onClick:y},{default:f(()=>[A(v(a.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"])}}}),re={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},me={class:"md:w-3/4 md:mx-auto py-5 mx-5"},de={class:"flex items-center justify-between mb-5"},ce={key:0,class:"text-lg font-semibold text-ink-gray-9"},ge={key:1,class:"grid grid-cols-2 gap-5"},pe={key:2,class:"flex justify-center my-5"},_e={__name:"Assignments",setup(p){const c=S("$user"),b=S("$dayjs"),s=k(""),o=k(""),y=k(!1),w=k("new"),a=k(0),{brand:n}=Q(),_=W(),r=window.read_only_mode;G(()=>{!c.data?.is_moderator&&!c.data?.is_instructor&&_.push({name:"Courses"}),U(),s.value=_.currentRoute.value.query.title,o.value=_.currentRoute.value.query.type}),T([s,o],()=>{_.push({query:{title:s.value,type:o.value}}),M()});const M=()=>{i.update({filters:F.value}),i.reload()},F=V(()=>{let l={};return s.value&&(l.title=["like",`%${s.value}%`]),o.value&&(l.type=o.value),c.data?.is_moderator||(l.owner=c.data?.email),l}),i=H({doctype:"LMS Assignment",fields:["name","title","type","creation","question"],orderBy:"modified desc",cache:["assignments"],transform(l){return l.map(t=>({...t,creation:b(t.creation).fromNow()}))}}),R=V(()=>[{label:__("Title"),key:"title",width:2},{label:__("Type"),key:"type",width:1,align:"left"},{label:__("Created"),key:"creation",width:1,align:"right"}]),U=()=>{J("frappe.client.get_count",{doctype:"LMS Assignment"}).then(l=>{a.value=l})},L=V(()=>["","Document","Image","PDF","URL","Text"].map(t=>({label:__(t),value:t}))),N=V(()=>[{label:"Assignments",route:{name:"Assignments"}}]);return K(()=>({title:__("Assignments"),icon:n.favicon})),(l,t)=>(g(),D(ee,null,[d("header",re,[u(e(se),{items:N.value},null,8,["items"]),e(r)?h("",!0):(g(),x(e($),{key:0,variant:"solid",onClick:t[0]||(t[0]=()=>{w.value="new",y.value=!0})},{prefix:f(()=>[u(e(X),{class:"w-4 h-4"})]),default:f(()=>[A(" "+v(l.__("New")),1)]),_:1}))]),d("div",me,[d("div",de,[a.value?(g(),D("div",ce,v(l.__("{0} Assignments").format(a.value)),1)):h("",!0),e(i).data?.length||a.value>0?(g(),D("div",ge,[u(e(C),{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=m=>s.value=m),placeholder:l.__("Search by title")},null,8,["modelValue","placeholder"]),u(e(C),{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=m=>o.value=m),type:"select",options:L.value,placeholder:l.__("Type")},null,8,["modelValue","options","placeholder"])])):h("",!0)]),e(i).data?.length?(g(),x(e(Y),{key:0,columns:R.value,rows:e(i).data,"row-key":"name",options:{showTooltip:!1,selectable:!1,onRowClick:m=>{e(r)||(w.value=m.name,y.value=!0)}}},null,8,["columns","rows","options"])):(g(),x(te,{key:1,type:"Assignments"})),e(i).data&&e(i).hasNextPage?(g(),D("div",pe,[u(e($),{onClick:t[3]||(t[3]=m=>e(i).next())},{default:f(()=>[A(v(l.__("Load More")),1)]),_:1})])):h("",!0)]),u(ue,{modelValue:y.value,"onUpdate:modelValue":t[4]||(t[4]=m=>y.value=m),assignments:e(i),"onUpdate:assignments":t[5]||(t[5]=m=>Z(i)?i.value=m:null),assignmentID:w.value},null,8,["modelValue","assignments","assignmentID"])],64))}};export{_e as default};
//# sourceMappingURL=Assignments-ahSC1JkI.js.map
