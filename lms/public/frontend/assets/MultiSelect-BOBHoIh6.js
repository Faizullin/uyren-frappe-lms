import{J as P,K as A,cz as T,r as f,b as _,cA as L,A as R,e as u,f as o,k as g,g as r,C as M,p as U,t as x,h as c,n as p,l,bw as I,bm as J,cB as X,F as S,x as $,j as Y,cC as G,_ as H,P as Q,bn as W,cD as Z,bY as ee,bB as te,cE as se,br as ae,a3 as le}from"./index-DcFDtKzU.js";const oe={key:0,class:"text-ink-red-3"},re={class:"w-full"},ue={class:"mt-1 rounded-lg bg-surface-white py-1 text-base border-2"},ne={class:"flex flex-col gap-1 p-1"},ie={class:"text-base font-medium text-ink-gray-8"},ce={class:"text-sm text-ink-gray-5"},de={key:0,class:"absolute bottom-2 left-1 w-[99%] pt-2 bg-white border-t"},fe={key:1,class:"grid grid-cols-2 gap-2 mt-1"},pe={class:"flex items-center justify-between break-all bg-surface-gray-2 text-ink-gray-7 word-wrap p-2 rounded-md mr-2"},me={class:"break-all"},ye={__name:"MultiSelect",props:P({label:{type:String},size:{type:String,default:"sm"},doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},validate:{type:Function,default:null},errorMessage:{type:Function,default:n=>`${n} is an Invalid value`},required:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n,{expose:z}){const i=n,a=A(n,"modelValue"),C=T(),v=f([]),V=f(null),k=f(null),d=f(""),y=f(""),b=f(!1),B=_({get:()=>d.value||"",set:e=>{d.value="",e&&(b.value=!1),e?.value&&q(e.value)}});L(d,e=>{e=e||"",y.value!==e&&(y.value=e,j(e))},{debounce:300,immediate:!0});const w=R({url:"frappe.desk.search.search_link",method:"POST",cache:[y.value,i.doctype],auto:!0,params:{txt:y.value,doctype:i.doctype}}),N=_(()=>w.data||[]);function j(e){w.update({params:{txt:e,doctype:i.doctype}}),w.reload()}const q=e=>{k.value=null,e&&(e.split(",").forEach(t=>{if(t=t.trim(),t&&!a.value?.includes(t)){if(t&&i.validate&&!i.validate(t)){k.value=i.errorMessage(t);return}a.value?a.value.push(t):a.value=[t],t=t.replace(t,"")}}),!k.value&&(e=""))},D=e=>{a.value=a.value.filter(s=>s!==e)},E=()=>{if(d.value)return;let e=v.value[v.value.length-1]?.$el;document.activeElement===e?(a.value.pop(),le(()=>{a.value.length?(e=v.value[v.value.length-1].$el,e?.focus()):F()})):e?.focus()};function F(){V.value.$el.focus()}z({setFocus:F});const K=_(()=>[{sm:"text-xs",md:"text-base"}[i.size||"sm"],"text-ink-gray-5"]);return(e,s)=>(o(),u("div",null,[n.label?(o(),u("label",{key:0,class:M(["block mb-1",K.value])},[U(x(n.label)+" ",1),n.required?(o(),u("span",oe,"*")):g("",!0)],2)):g("",!0),r("div",re,[c(l(se),{modelValue:B.value,"onUpdate:modelValue":s[2]||(s[2]=t=>B.value=t),nullable:""},{default:p(()=>[c(l(I),{class:"w-full",show:b.value,"onUpdate:show":s[1]||(s[1]=t=>b.value=t)},{target:p(({togglePopover:t})=>[c(l(Z),{ref_key:"search",ref:V,class:"search-input form-input w-full focus-visible:!ring-0",type:"text",value:d.value,onChange:s[0]||(s[0]=h=>{d.value=h.target.value,b.value=!0}),autocomplete:"off",onFocus:()=>t(),onKeydownCapture:ee(te(E,["stop"]),["delete"])},null,8,["value","onFocus","onKeydownCapture"])]),body:p(({isOpen:t,close:h})=>[J(r("div",null,[r("div",ue,[c(l(X),{class:"my-1 min-h-[6rem] max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:p(()=>[(o(!0),u(S,null,$(N.value,m=>(o(),Y(l(G),{key:m.value,value:m},{default:p(({active:O})=>[r("li",{class:M(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-surface-gray-2":O}])},[r("div",ne,[r("div",ie,x(m.description),1),r("div",ce,x(m.value),1)])],2)]),_:2},1032,["value"]))),128)),s[3]||(s[3]=r("div",{class:"h-10"},null,-1)),l(C).onCreate?(o(),u("div",de,[c(l(H),{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),onClick:m=>l(C).onCreate(h)},{prefix:p(()=>[c(l(Q),{class:"h-4 w-4 stroke-1.5"})]),_:2},1032,["label","onClick"])])):g("",!0)]),_:2,__:[3]},1024)])],512),[[W,t]])]),_:1},8,["show"])]),_:1},8,["modelValue"])]),a.value.length?(o(),u("div",fe,[(o(!0),u(S,null,$(a.value,t=>(o(),u("div",pe,[r("span",me,x(t),1),c(l(ae),{class:"size-4 stroke-1.5 cursor-pointer",onClick:h=>D(t)},null,8,["onClick"])]))),256))])):g("",!0)]))}};export{ye as _};
//# sourceMappingURL=MultiSelect-BOBHoIh6.js.map
