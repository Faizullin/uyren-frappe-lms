import{_ as Y}from"./EmptyState.vue_vue_type_script_setup_true_lang-6vpbuXAr.js";import{aJ as R,V as T,W as z,g as w,D as N,dr as G,c as m,o as n,d as l,t as p,as as j,F as S,f as M,k as H,h as V,v as K,b as a,p as t,H as k,w as o,bl as Z,aC as O,e as y,P as B,C as q,z as A,r as F,E as L,a2 as Q,bW as J,I as U,aU as X,Y as ee,R as D,B as se,i as te,u as ae,n as le,l as oe,a as re,Z as ne}from"./index-RevCnO16.js";import{_ as ie}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CeasAM64.js";const ue={class:"text-xs text-ink-gray-5 mb-2"},ce={class:"overflow-x-auto border rounded-md"},de=["onUpdate:modelValue"],me={key:0,class:"absolute right-[30px] top-5 mt-1 w-32 bg-surface-white border border-outline-gray-1 rounded-md shadow-sm"},pe=["onClick"],_e={class:"mt-2"},ge=R({__name:"ChildTable",props:T({modelValue:{},columns:{default:[]},label:{}},{modelValue:{},modelModifiers:{}}),emits:T(["update:modelValue"],["update:modelValue"]),setup(E,{emit:x}){const u=z(E,"modelValue"),c=w(null),f=w(null),d=w(""),h=x,C=w(E.columns);N(u,()=>{u.value?.length<1&&P()});const P=()=>{u.value||(u.value=[]);let e={};C.value.forEach(s=>{e[s.toLowerCase().split(" ").join("_")]=""}),u.value.push(e),h("update:modelValue",u.value)},_=e=>{u.value.splice(e,1),h("update:modelValue",u.value)},$=()=>[...Array(C.value.length).fill("1fr"),"0.25fr"].join(" "),g=(e,s)=>{f.value=f.value===e?null:e,d.value=`${s.clientY+10}px`};G(c,()=>{f.value=null});const v=e=>C.value.map(r=>r.toLowerCase().split(" ").join("_")).includes(e);return(e,s)=>(n(),m("div",null,[l("div",ue,p(e.label),1),l("div",ce,[l("div",{class:"grid items-center space-x-4 p-2 border-b",style:j({gridTemplateColumns:$()})},[(n(!0),m(S,null,M(C.value,(r,i)=>(n(),m("div",{key:i,class:"text-sm text-ink-gray-5"},p(r),1))),128)),s[0]||(s[0]=l("div",null,null,-1))],4),(n(!0),m(S,null,M(u.value,(r,i)=>(n(),m("div",{key:i,class:"grid items-center space-x-4 p-2",style:j({gridTemplateColumns:$()})},[(n(!0),m(S,null,M(Object.keys(r),b=>(n(),m(S,{key:b},[v(b)?H((n(),m("input",{key:0,"onUpdate:modelValue":W=>r[b]=W,class:"py-1.5 px-2 border-none focus:ring-0 focus:border focus:border-gray-300 focus:bg-surface-gray-2 rounded-sm text-sm focus:outline-none"},null,8,de)),[[K,r[b]]]):V("",!0)],64))),128)),l("div",{class:"relative",ref_for:!0,ref_key:"menuRef",ref:c},[a(t(k),{variant:"ghost",onClick:b=>g(i,b)},{icon:o(()=>[a(t(Z),{class:"size-4 text-ink-gray-7 stroke-1.5 cursor-pointer"})]),_:2},1032,["onClick"]),f.value===i?(n(),m("div",me,[l("button",{onClick:b=>_(i),class:"flex items-center space-x-2 w-full text-left px-3 py-2 text-sm text-ink-red-3"},[a(t(O),{class:"size-4 stroke-1.5"}),l("span",null,p(e.__("Delete")),1)],8,pe)])):V("",!0)],512)],4))),128))]),l("div",_e,[a(t(k),{onClick:P},{prefix:o(()=>[a(t(B),{class:"size-4 text-ink-gray-7"})]),default:o(()=>[y(" "+p(e.__("Add Row")),1)]),_:1})])]))}}),ve={class:"text-xl font-semibold text-ink-gray-9"},fe={class:"grid grid-cols-2 gap-10"},xe={class:"space-y-4"},be={class:"text-xs text-ink-gray-5 mb-2"},ye={class:"flex justify-end space-x-2 group"},ke=R({__name:"ProgrammingExerciseForm",props:T({exerciseID:{default:"new"}},{modelValue:{},modelModifiers:{},exercises:{},exercisesModifiers:{}}),emits:["update:modelValue","update:exercises"],setup(E){const x=z(E,"modelValue"),u=z(E,"exercises"),c=w({title:"",language:"Python",problem_statement:"",test_cases:[]}),f=[{label:"Python",value:"Python"},{label:"JavaScript",value:"JavaScript"}],d=E;N(()=>d.exerciseID,()=>{h(),C()});const h=()=>{let e=!0;u.value?.data.forEach(s=>{s.name===d.exerciseID&&(e=!1,c.value={...s})}),e&&(c.value={title:"",language:"Python",problem_statement:"",test_cases:[]})},I=q({doctype:"LMS Test Case",fields:["input","expected_output","name"],cache:["testCases",d.exerciseID],parent:"LMS Programming Exercise",onSuccess(e){c.value.test_cases=e}}),C=()=>{I.update({filters:{parent:d.exerciseID,parenttype:"LMS Programming Exercise",parentfield:"test_cases"}}),I.reload()},P=e=>{d.exerciseID=="new"?_(e):$(e)},_=e=>{u.value?.insert.submit({...c.value},{onSuccess(){e(),u.value?.reload(),D.success(__("Programming Exercise created successfully"))},onError(s){D.warning(__(s.messages?.[0]||s))}})},$=e=>{u.value?.setValue.submit({name:d.exerciseID,...c.value},{onSuccess(){e(),u.value?.reload(),D.success(__("Programming Exercise updated successfully"))},onError(s){D.warning(__(s.messages?.[0]||s))}})},g=A(()=>["Input","Expected Output"]),v=e=>{d.exerciseID!="new"&&u.value?.delete.submit(d.exerciseID,{onSuccess(){D.success(__("Programming Exercise deleted successfully")),e()},onError(s){D.warning(__(s.messages?.[0]||s))}})};return(e,s)=>{const r=F("router-link");return n(),L(t(ee),{modelValue:x.value,"onUpdate:modelValue":s[4]||(s[4]=i=>x.value=i),options:{size:"5xl"}},{"body-title":o(()=>[l("div",ve,p(d.exerciseID==="new"?e.__("Create Programming Exercise"):e.__("Edit Programming Exercise")),1)]),"body-content":o(()=>[l("div",fe,[l("div",xe,[a(t(U),{modelValue:c.value.title,"onUpdate:modelValue":s[0]||(s[0]=i=>c.value.title=i),label:e.__("Title"),required:!0},null,8,["modelValue","label"]),a(t(U),{modelValue:c.value.language,"onUpdate:modelValue":s[1]||(s[1]=i=>c.value.language=i),label:e.__("Language"),type:"select",options:f,required:!0},null,8,["modelValue","label"]),a(ge,{modelValue:c.value.test_cases,"onUpdate:modelValue":s[2]||(s[2]=i=>c.value.test_cases=i),label:e.__("Test Cases"),columns:g.value,required:!0,addable:!0,deletable:!0,editable:!0,placeholder:e.__("Add Test Case")},null,8,["modelValue","label","columns","placeholder"])]),l("div",null,[l("div",null,[l("div",be,[y(p(e.__("Problem Statement"))+" ",1),s[5]||(s[5]=l("span",{class:"text-ink-red-3"},"*",-1))]),a(t(X),{content:c.value.problem_statement,onChange:s[3]||(s[3]=i=>c.value.problem_statement=i),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[21rem] overflow-y-auto"},null,8,["content"])])])])]),actions:o(({close:i})=>[l("div",ye,[e.exerciseID!="new"?(n(),L(t(k),{key:0,onClick:b=>v(i),variant:"outline",theme:"red",class:"invisible group-hover:visible"},{prefix:o(()=>[a(t(O),{class:"size-4 stroke-1.5"})]),default:o(()=>[y(" "+p(e.__("Delete")),1)]),_:2},1032,["onClick"])):V("",!0),a(r,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:d.exerciseID,submissionID:"new"}}},{default:o(()=>[a(t(k),null,{prefix:o(()=>[a(t(Q),{class:"size-4 stroke-1.5"})]),default:o(()=>[y(" "+p(e.__("Test this Exercise")),1)]),_:1})]),_:1},8,["to"]),a(r,{to:{name:"ProgrammingExerciseSubmissions",query:{exercise:d.exerciseID}}},{default:o(()=>[a(t(k),null,{prefix:o(()=>[a(t(J),{class:"size-4 stroke-1.5"})]),default:o(()=>[y(" "+p(e.__("Check Submission")),1)]),_:1})]),_:1},8,["to"]),a(t(k),{variant:"solid",onClick:b=>P(i)},{default:o(()=>[y(p(e.__("Save")),1)]),_:2},1032,["onClick"])])]),_:1},8,["modelValue"])}}}),he={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},Ce={class:"space-x-2"},we={class:"md:w-4/5 md:mx-auto p-5"},Ee={class:"flex items-center justify-between mb-5"},Ve={key:0,class:"text-lg font-semibold text-ink-gray-9"},Pe={key:1,class:"grid grid-cols-2 gap-5"},$e={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},De=["onClick"],Se={class:"text-lg font-semibold text-ink-gray-9"},Ie={class:"text-sm text-ink-gray-7"},Me={key:2,class:"flex justify-center my-5"},Re=R({__name:"ProgrammingExercises",setup(E){const x=w(0),u=window.read_only_mode,{brand:c}=se(),f=w(!1),d=w("new"),h=te("$user"),I=ae();le(()=>{C(),P()});const C=()=>{!h.data?.is_instructor&&!h.data?.is_moderator&&!h.data?.is_evaluator&&I.push({name:"ProgrammingExerciseSubmissions"})},P=()=>{oe("frappe.client.get_count",{doctype:"LMS Programming Exercise"}).then(g=>{x.value=g}).catch(g=>{console.error("Error fetching exercise count:",g)})},_=q({doctype:"LMS Programming Exercise",cache:["programmingExercises"],fields:["name","title","language","problem_statement"],auto:!0});re(()=>({title:__("Programming Exercises"),icon:c.favicon}));const $=A(()=>[{label:__("Programming Exercises"),route:{name:"ProgrammingExercises"}}]);return(g,v)=>{const e=F("router-link"),s=Y;return n(),m(S,null,[l("header",he,[a(t(ie),{items:$.value},null,8,["items"]),l("div",Ce,[a(e,{to:{name:"ProgrammingExerciseSubmissions"}},{default:o(()=>[a(t(k),null,{prefix:o(()=>[a(t(J),{class:"size-4 stroke-1.5"})]),default:o(()=>[y(" "+p(g.__("Check All Submissions")),1)]),_:1})]),_:1}),t(u)?V("",!0):(n(),L(t(k),{key:0,variant:"solid",onClick:v[0]||(v[0]=()=>{d.value="new",f.value=!0})},{prefix:o(()=>[a(t(B),{class:"h-4 w-4 stroke-1.5"})]),default:o(()=>[y(" "+p(g.__("New")),1)]),_:1}))])]),l("div",we,[l("div",Ee,[x.value?(n(),m("div",Ve,p(g.__("{0} Exercises").format(x.value)),1)):V("",!0),t(_).data?.length||x.value>0?(n(),m("div",Pe)):V("",!0)]),t(_).data?.length?(n(),m("div",$e,[(n(!0),m(S,null,M(t(_).data,r=>(n(),m("div",{key:r.name,onClick:()=>{d.value=r.name,f.value=!0},class:"flex flex-col border rounded-md p-3 h-full hover:border-outline-gray-3 space-y-2 cursor-pointer"},[l("div",Se,p(r.title),1),l("div",Ie,p(r.language),1)],8,De))),128))])):(n(),L(s,{key:1,type:"Programming Exercises"})),t(_).data&&t(_).hasNextPage?(n(),m("div",Me,[a(t(k),{onClick:v[1]||(v[1]=r=>t(_).next())},{default:o(()=>[y(p(g.__("Load More")),1)]),_:1})])):V("",!0)]),a(ke,{modelValue:f.value,"onUpdate:modelValue":v[2]||(v[2]=r=>f.value=r),exerciseID:d.value,exercises:t(_),"onUpdate:exercises":v[3]||(v[3]=r=>ne(_)?_.value=r:null)},null,8,["modelValue","exerciseID","exercises"])],64)}}});export{Re as default};
//# sourceMappingURL=ProgrammingExercises-BJCDxRZN.js.map
