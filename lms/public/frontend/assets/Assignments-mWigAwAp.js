import"@headlessui/vue";import{au as N,J as P,K as I,L as B,w as S,b as V,d as z,j as x,f as c,n as f,g as d,t as v,h as u,l as e,q as C,p as A,aG as E,k as h,_ as $,M as O,H as q,i as M,r as k,s as G,z as H,o as J,c as K,a as Q,u as W,e as D,P as X,ao as Y,N as Z,F as ee}from"./index-BIerRe8o.js";import{_ as te}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-Cdx-1Hlv.js";import"@tiptap/extension-code-block-lowlight";import"@tiptap/extension-placeholder";import"@tiptap/extension-table";import"@tiptap/extension-table-cell";import"@tiptap/extension-table-header";import"@tiptap/extension-table-row";import"@tiptap/extension-text-align";import"@tiptap/extension-text-style";import"@tiptap/extension-typography";import"@tiptap/vue-3";import"@tiptap/extension-mention";import"@vueuse/core";import{_ as se}from"./EmptyState.vue_vue_type_script_setup_true_lang-CbCenUow.js";import"@tiptap/core";import"@tiptap/extension-code-block";import"@tiptap/extension-heading";import"@tiptap/suggestion";import"@tiptap/extension-link";const ne={class:"p-5 text-base"},ae={class:"text-lg text-ink-gray-9 font-semibold mb-5"},le={class:"space-y-4 max-h-[75vh] overflow-y-auto"},oe={class:"text-xs text-ink-gray-5 mb-2"},ie={class:"flex justify-end space-x-2 mt-5"},ue=N({__name:"AssignmentForm",props:P({assignmentID:{type:String,default:"new"}},{modelValue:{},modelModifiers:{},assignments:{},assignmentsModifiers:{}}),emits:["update:modelValue","update:assignments"],setup(g){const p=I(g,"modelValue"),b=I(g,"assignments"),t=B({title:"",type:"",question:""}),o=g;S(()=>o.assignmentID,a=>{a!=="new"&&b.value?.data.forEach(n=>{n.name===a&&(t.title=n.title,t.type=n.type,t.question=n.question)})},{flush:"post"});const y=()=>{o.assignmentID=="new"?b.value.insert.submit({...t},{onSuccess(){p.value=!1,q.success(__("Assignment created successfully"))}}):b.value.setValue.submit({...t,name:o.assignmentID},{onSuccess(){p.value=!1,q.success(__("Assignment updated successfully"))}})},w=V(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(a,n)=>{const _=z("router-link");return c(),x(e(O),{modelValue:p.value,"onUpdate:modelValue":n[3]||(n[3]=r=>p.value=r),options:{size:"lg"}},{body:f(()=>[d("div",ne,[d("div",ae,v(g.assignmentID==="new"?a.__("Create an Assignment"):a.__("Edit Assignment")),1),d("div",le,[u(e(C),{modelValue:t.title,"onUpdate:modelValue":n[0]||(n[0]=r=>t.title=r),label:a.__("Title"),required:!0},null,8,["modelValue","label"]),u(e(C),{modelValue:t.type,"onUpdate:modelValue":n[1]||(n[1]=r=>t.type=r),type:"select",options:w.value,label:a.__("Submission Type"),required:!0},null,8,["modelValue","options","label"]),d("div",null,[d("div",oe,[A(v(a.__("Question"))+" ",1),n[4]||(n[4]=d("span",{class:"text-ink-red-3"},"*",-1))]),u(e(E),{content:t.question,onChange:n[2]||(n[2]=r=>t.question=r),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[18rem] overflow-y-auto"},null,8,["content"])])]),d("div",ie,[u(_,{to:{name:"AssignmentSubmissionList",query:{assignmentID:g.assignmentID}}},{default:f(()=>[g.assignmentID!=="new"?(c(),x(e($),{key:0,variant:"subtle"},{default:f(()=>[A(v(a.__("Check Submissions")),1)]),_:1})):h("",!0)]),_:1},8,["to"]),u(e($),{variant:"solid",onClick:y},{default:f(()=>[A(v(a.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"])}}}),re={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},me={class:"md:w-3/4 md:mx-auto py-5 mx-5"},de={class:"flex items-center justify-between mb-5"},pe={key:0,class:"text-lg font-semibold text-ink-gray-9"},ce={key:1,class:"grid grid-cols-2 gap-5"},ge={key:2,class:"flex justify-center my-5"},Le={__name:"Assignments",setup(g){const p=M("$user"),b=M("$dayjs"),t=k(""),o=k(""),y=k(!1),w=k("new"),a=k(0),{brand:n}=G(),_=H(),r=window.read_only_mode;J(()=>{!p.data?.is_moderator&&!p.data?.is_instructor&&_.push({name:"Courses"}),L(),t.value=_.currentRoute.value.query.title,o.value=_.currentRoute.value.query.type}),S([t,o],()=>{_.push({query:{title:t.value,type:o.value}}),T()});const T=()=>{i.update({filters:F.value}),i.reload()},F=V(()=>{let l={};return t.value&&(l.title=["like",`%${t.value}%`]),o.value&&(l.type=o.value),p.data?.is_moderator||(l.owner=p.data?.email),l}),i=K({doctype:"LMS Assignment",fields:["name","title","type","creation","question"],orderBy:"modified desc",cache:["assignments"],transform(l){return l.map(s=>({...s,creation:b(s.creation).fromNow()}))}}),U=V(()=>[{label:__("Title"),key:"title",width:2},{label:__("Type"),key:"type",width:1,align:"left"},{label:__("Created"),key:"creation",width:1,align:"right"}]),L=()=>{Q("frappe.client.get_count",{doctype:"LMS Assignment"}).then(l=>{a.value=l})},R=V(()=>["","Document","Image","PDF","URL","Text"].map(s=>({label:__(s),value:s}))),j=V(()=>[{label:"Assignments",route:{name:"Assignments"}}]);return W(()=>({title:__("Assignments"),icon:n.favicon})),(l,s)=>(c(),D(ee,null,[d("header",re,[u(e(te),{items:j.value},null,8,["items"]),e(r)?h("",!0):(c(),x(e($),{key:0,variant:"solid",onClick:s[0]||(s[0]=()=>{w.value="new",y.value=!0})},{prefix:f(()=>[u(e(X),{class:"w-4 h-4"})]),default:f(()=>[A(" "+v(l.__("New")),1)]),_:1}))]),d("div",me,[d("div",de,[a.value?(c(),D("div",pe,v(l.__("{0} Assignments").format(a.value)),1)):h("",!0),e(i).data?.length||a.value>0?(c(),D("div",ce,[u(e(C),{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=m=>t.value=m),placeholder:l.__("Search by title")},null,8,["modelValue","placeholder"]),u(e(C),{modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=m=>o.value=m),type:"select",options:R.value,placeholder:l.__("Type")},null,8,["modelValue","options","placeholder"])])):h("",!0)]),e(i).data?.length?(c(),x(e(Y),{key:0,columns:U.value,rows:e(i).data,"row-key":"name",options:{showTooltip:!1,selectable:!1,onRowClick:m=>{e(r)||(w.value=m.name,y.value=!0)}}},null,8,["columns","rows","options"])):(c(),x(se,{key:1,type:"Assignments"})),e(i).data&&e(i).hasNextPage?(c(),D("div",ge,[u(e($),{onClick:s[3]||(s[3]=m=>e(i).next())},{default:f(()=>[A(v(l.__("Load More")),1)]),_:1})])):h("",!0)]),u(ue,{modelValue:y.value,"onUpdate:modelValue":s[4]||(s[4]=m=>y.value=m),assignments:e(i),"onUpdate:assignments":s[5]||(s[5]=m=>Z(i)?i.value=m:null),assignmentID:w.value},null,8,["modelValue","assignments","assignmentID"])],64))}};export{Le as default};
//# sourceMappingURL=Assignments-mWigAwAp.js.map
