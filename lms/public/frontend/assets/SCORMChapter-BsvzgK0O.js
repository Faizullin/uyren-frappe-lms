import{x as M,$ as N,i as w,g as $,aa as x,ab as E,z as G,I as y,q as D,a as P,c as u,o as l,d as n,h as T,b as _,s as a,t as S,w as V,e as I,D as R,F as z,l as B}from"./index-CgbsATbs.js";import{_ as F}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-KbxUUXyD.js";const k={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},q={key:0},A=["src"],j={key:1},O={class:"text-center pt-10 px-5 md:px-0 pb-10"},Y={class:"text-center"},H={class:"mb-4"},U={__name:"SCORMChapter",props:{courseName:{type:String,required:!0},chapterName:{type:String,required:!0}},setup(h){const{brand:f}=M(),g=N(),o=w("$user"),i=$(!1),r=h;x(()=>{g.isSidebarCollapsed=!0,C()});const t=E({doctype:"Course Chapter",name:r.chapterName,auto:!0,cache:["chapter",r.chapterName],onSuccess(e){p.submit()}}),c=G({doctype:"LMS Enrollment",fields:["member","course"],filters:{course:r.courseName,member:o.data?.name},auto:!0,cache:["enrollments",r.courseName,o.data?.name]}),m=e=>e=="cmi.core.lesson_status"?p.data?.status=="Complete"?"passed":"incomplete":"",d=(e,s)=>{e=="cmi.core.lesson_status"&&s=="passed"&&b()},b=()=>{B("lms.lms.doctype.course_lesson.course_lesson.save_progress",{lesson:t.doc.lessons[0].lesson,course:r.courseName})},p=y({url:"frappe.client.get_value",makeParams(e){return{doctype:"LMS Course Progress",fieldname:"status",filters:{member:o.data?.name,lesson:t.doc.lessons[0].lesson,chapter:t.doc.name,course:t.doc?.course}}},onSuccess(e){i.value=!0}}),v=()=>{c.insert.submit({course:r.courseName,member:o.data?.name},{onSuccess(e){window.location.reload()}})},C=()=>{window.API_1484_11={Initialize:()=>"true",Terminate:()=>"true",GetValue:e=>(console.log(`GET: ${e}`),m(e)),SetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),d(e,s),"true"),Commit:()=>"true",GetLastError:()=>"0",GetErrorString:()=>"",GetDiagnostic:()=>""},window.API={LMSInitialize:()=>"true",LMSFinish:()=>"true",LMSGetValue:e=>(console.log(`GET: ${e}`),m(e)),LMSSetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),d(e,s),"true"),LMSCommit:()=>"true",LMSGetLastError:()=>"0",LMSGetErrorString:()=>"",LMSGetDiagnostic:()=>""}},L=D(()=>[{label:"Courses",route:{name:"Courses"}},{label:t.doc?.course_title,route:{name:"CourseDetail",params:{courseName:r.courseName}}},{label:t.doc?.title}]);return P(()=>({title:t.doc?.title,icon:f.favicon})),(e,s)=>(l(),u(z,null,[n("header",k,[_(a(F),{class:"h-7",items:L.value},null,8,["items"])]),i.value&&(a(c).data?.length||a(o).data?.is_moderator||a(o).data?.is_instructor)?(l(),u("div",q,[n("iframe",{src:a(t).doc.launch_file,class:"w-full h-screen"},null,8,A)])):a(c).data?.length?T("",!0):(l(),u("div",j,[n("div",O,[n("div",Y,[n("div",H,S(e.__("You are not enrolled in this course. Please enroll to access this lesson.")),1),_(a(R),{variant:"solid",onClick:s[0]||(s[0]=J=>v())},{default:V(()=>[I(S(e.__("Start Learning")),1)]),_:1})])])]))],64))}};export{U as default};
//# sourceMappingURL=SCORMChapter-BsvzgK0O.js.map
