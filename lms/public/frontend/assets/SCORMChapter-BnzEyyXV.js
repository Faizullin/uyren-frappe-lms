import{s as M,T as N,i as w,r as E,a4 as G,a5 as $,c as x,A as y,b as T,u as P,e as u,f as l,g as n,k as V,h as _,l as a,t as S,n as D,p as R,_ as I,F as k,a as A}from"./index-DcFDtKzU.js";import{_ as B}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DSPCRa1r.js";const F={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},z={key:0},j=["src"],q={key:1},O={class:"text-center pt-10 px-5 md:px-0 pb-10"},Y={class:"text-center"},H={class:"mb-4"},U={__name:"SCORMChapter",props:{courseName:{type:String,required:!0},chapterName:{type:String,required:!0}},setup(h){const{brand:f}=M(),g=N(),o=w("$user"),i=E(!1),r=h;G(()=>{g.isSidebarCollapsed=!0,C()});const t=$({doctype:"Course Chapter",name:r.chapterName,auto:!0,cache:["chapter",r.chapterName],onSuccess(e){p.submit()}}),c=x({doctype:"LMS Enrollment",fields:["member","course"],filters:{course:r.courseName,member:o.data?.name},auto:!0,cache:["enrollments",r.courseName,o.data?.name]}),m=e=>e=="cmi.core.lesson_status"?p.data?.status=="Complete"?"passed":"incomplete":"",d=(e,s)=>{e=="cmi.core.lesson_status"&&s=="passed"&&b()},b=()=>{A("lms.lms.doctype.course_lesson.course_lesson.save_progress",{lesson:t.doc.lessons[0].lesson,course:r.courseName})},p=y({url:"frappe.client.get_value",makeParams(e){return{doctype:"LMS Course Progress",fieldname:"status",filters:{member:o.data?.name,lesson:t.doc.lessons[0].lesson,chapter:t.doc.name,course:t.doc?.course}}},onSuccess(e){i.value=!0}}),v=()=>{c.insert.submit({course:r.courseName,member:o.data?.name},{onSuccess(e){window.location.reload()}})},C=()=>{window.API_1484_11={Initialize:()=>"true",Terminate:()=>"true",GetValue:e=>(console.log(`GET: ${e}`),m(e)),SetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),d(e,s),"true"),Commit:()=>"true",GetLastError:()=>"0",GetErrorString:()=>"",GetDiagnostic:()=>""},window.API={LMSInitialize:()=>"true",LMSFinish:()=>"true",LMSGetValue:e=>(console.log(`GET: ${e}`),m(e)),LMSSetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),d(e,s),"true"),LMSCommit:()=>"true",LMSGetLastError:()=>"0",LMSGetErrorString:()=>"",LMSGetDiagnostic:()=>""}},L=T(()=>[{label:"Courses",route:{name:"Courses"}},{label:t.doc?.course_title,route:{name:"CourseDetail",params:{courseName:r.courseName}}},{label:t.doc?.title}]);return P(()=>({title:t.doc?.title,icon:f.favicon})),(e,s)=>(l(),u(k,null,[n("header",F,[_(a(B),{class:"h-7",items:L.value},null,8,["items"])]),i.value&&(a(c).data?.length||a(o).data?.is_moderator||a(o).data?.is_instructor)?(l(),u("div",z,[n("iframe",{src:a(t).doc.launch_file,class:"w-full h-screen"},null,8,j)])):a(c).data?.length?V("",!0):(l(),u("div",q,[n("div",O,[n("div",Y,[n("div",H,S(e.__("You are not enrolled in this course. Please enroll to access this lesson.")),1),_(a(I),{variant:"solid",onClick:s[0]||(s[0]=J=>v())},{default:D(()=>[R(S(e.__("Start Learning")),1)]),_:1})])])]))],64))}};export{U as default};
//# sourceMappingURL=SCORMChapter-BnzEyyXV.js.map
