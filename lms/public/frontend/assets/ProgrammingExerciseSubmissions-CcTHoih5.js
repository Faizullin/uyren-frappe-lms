import{az as B,x as j,i as S,g as L,u as z,y as A,q as p,z as D,A as U,a as T,r as I,c as m,o as l,d as _,b as r,s as e,B as y,h as g,t as b,ak as E,E as J,w as n,al as K,F as v,f as P,am as O,ag as G,ao as H,ap as Q,aq as W,J as X,e as V,aA as Y,ar as Z,D as w,as as ee,at as se,N as ae}from"./index-CgbsATbs.js";import{_ as te}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-KbxUUXyD.js";import{_ as re}from"./EmptyState.vue_vue_type_script_setup_true_lang-DGwjDck2.js";const ie={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},oe={class:"p-6"},le={class:"flex items-center justify-between space-x-32 mb-5"},ne={class:"text-xl font-semibold text-ink-gray-7"},ue={key:0,class:"grid grid-cols-3 gap-5 flex-1"},me={key:0},ce={key:0},de={key:1},_e={class:"flex gap-2"},fe={key:2,class:"flex justify-center my-5"},ve=B({__name:"ProgrammingExerciseSubmissions",setup(ye){const{brand:F}=j(),q=S("$dayjs"),f=S("$user"),h=["exercise","member","status"],o=L({exercise:"",member:"",status:""}),c=z();A(()=>{C(),M()});const C=()=>{h.forEach(s=>{c.currentRoute.value.query[s]&&(o.value[s]=c.currentRoute.value.query[s])})},M=()=>{k.value?o.value.member=f.data?.name:i.reload()},i=D({doctype:"LMS Programming Exercise Submission",fields:["name","exercise","exercise_title","member_name","member_image","status","modified"],orderBy:"modified desc",transform(s){return s.map(a=>({...a,modified:q(a.modified).fromNow()}))}});U(o.value,()=>{let s={};h.forEach(a=>{if(o.value[a])s[a]=o.value[a],c.push({query:{...c.currentRoute.value.query,[a]:o.value[a]}});else{delete s[a];const d={...c.currentRoute.value.query};delete d[a],c.push({query:d})}}),i.update({filters:{...s}}),i.reload()});const N=(s,a)=>{Array.from(s).forEach(async d=>{await i.delete.submit(d)}),a(),ae.success(__("Submissions deleted successfully"))},k=p(()=>!f.data?.is_instructor&&!f.data?.is_moderator&&!f.data?.is_evaluator),x=p(()=>[{label:__("Member"),key:"member_name",width:"20%",icon:"user"},{label:__("Exercise"),key:"exercise_title",width:"30%",icon:"code"},{label:__("Status"),key:"status",width:"20%",icon:"check-circle"},{label:__("Modified"),key:"modified",width:"20%",icon:"clock",align:"right"}]),R=p(()=>[{label:__("Programming Exercise Submissions"),route:{name:"ProgrammingExerciseSubmissions"}}]);return T(()=>({title:__("Programming Exercises"),icon:F.favicon})),(s,a)=>{const d=I("router-link");return l(),m(v,null,[_("header",ie,[r(e(te),{items:R.value},null,8,["items"])]),_("div",oe,[_("div",le,[_("div",ne,b(e(i).data?.length?s.__("{0} Submissions").format(e(i).data.length):s.__("No Submissions")),1),e(i).data?.length?(l(),m("div",ue,[r(E,{doctype:"LMS Programming Exercise",modelValue:o.value.exercise,"onUpdate:modelValue":a[0]||(a[0]=t=>o.value.exercise=t),placeholder:s.__("Filter by Exercise")},null,8,["modelValue","placeholder"]),r(E,{doctype:"User",modelValue:o.value.member,"onUpdate:modelValue":a[1]||(a[1]=t=>o.value.member=t),placeholder:s.__("Filter by Member"),readonly:k.value},null,8,["modelValue","placeholder","readonly"]),r(e(J),{modelValue:o.value.status,"onUpdate:modelValue":a[2]||(a[2]=t=>o.value.status=t),type:"select",options:[{label:s.__(""),value:""},{label:s.__("Passed"),value:"Passed"},{label:s.__("Failed"),value:"Failed"}],placeholder:s.__("Filter by Status")},null,8,["modelValue","options","placeholder"])])):g("",!0)]),e(i).loading||e(i).data?.length?(l(),y(e(se),{key:0,columns:x.value,rows:e(i).data,rowKey:"name",options:{selectable:!0}},{default:n(()=>[r(e(K),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:n(()=>[(l(!0),m(v,null,P(x.value,t=>(l(),y(e(O),{item:t,key:t.key},{prefix:n(({item:u})=>[r(e(G),{name:u.icon?.toString(),class:"h-4 w-4"},null,8,["name"])]),_:2},1032,["item"]))),128))]),_:1}),r(e(H),null,{default:n(()=>[(l(!0),m(v,null,P(e(i).data,t=>(l(),y(d,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:t.exercise,submissionID:t.name}}},{default:n(()=>[r(e(Q),{row:t},{default:n(({column:u,item:$})=>[r(e(W),{item:t[u.key],align:u.align},{prefix:n(()=>[u.key=="member_name"?(l(),m("div",me,[r(e(Y),{class:"flex items-center",image:t.member_image,label:$,size:"sm"},null,8,["image","label"])])):g("",!0)]),default:n(()=>[u.key=="status"?(l(),m("div",ce,[r(e(X),{theme:t[u.key]==="Passed"?"green":"red"},{default:n(()=>[V(b(t[u.key]),1)]),_:2},1032,["theme"])])):(l(),m("div",de,b(t[u.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),r(e(Z),null,{actions:n(({unselectAll:t,selections:u})=>[_("div",_e,[r(e(w),{variant:"ghost",onClick:$=>N(u,t)},{default:n(()=>[r(e(ee),{class:"h-4 w-4 stroke-1.5"})]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(l(),y(re,{key:1,type:"Programming Exercise Submissions"})),e(i).data&&e(i).hasNextPage?(l(),m("div",fe,[r(e(w),{onClick:a[3]||(a[3]=t=>e(i).next())},{default:n(()=>[V(b(s.__("Load More")),1)]),_:1})])):g("",!0)])],64)}}});export{ve as default};
//# sourceMappingURL=ProgrammingExerciseSubmissions-CcTHoih5.js.map
