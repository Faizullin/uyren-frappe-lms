{"version":3,"file":"CourseCertification-bXJhLFD6.js","sources":["../../../../frontend-monorepo/website/src/pages/CourseCertification.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs class=\"h-7\" :items=\"breadcrumbs\" />\n\t</header>\n\t<div class=\"p-5\">\n\t\t<div v-if=\"certificate.data && Object.keys(certificate.data).length\">\n\t\t\t<div class=\"text-lg text-ink-gray-9 font-semibold mb-1\">\n\t\t\t\t{{ __('Certification') }}\n\t\t\t</div>\n\t\t\t<div class=\"text-ink-gray-9 text-sm\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'You are already certified for this course. Click on the card below to open your certificate.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"border p-3 w-fit min-w-60 rounded-md space-y-2 hover:bg-surface-gray-1 cursor-pointer mt-5\"\n\t\t\t\t@click=\"openCertificate(certificate.data)\"\n\t\t\t>\n\t\t\t\t<div class=\"text-ink-gray-9 font-semibold\">\n\t\t\t\t\t{{ courseTitle }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"text-sm text-ink-gray-7 font-medium\">\n\t\t\t\t\t{{ __('Issued On') }}:\n\t\t\t\t\t{{ dayjs(certificate.data.issue_date).format('DD MMM YYYY') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else>\n\t\t\t<UpcomingEvaluations v-if=\"courses.length\" :courses=\"courses\" />\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { computed, inject, onMounted, ref } from 'vue'\nimport { Breadcrumbs, call, createResource, usePageMeta } from '@mono/mono-frappe-ui'\nimport { useRouter } from 'vue-router'\nimport { sessionStore } from '../stores/session'\nimport UpcomingEvaluations from '@/components/UpcomingEvaluations.vue'\n\nconst courseTitle = ref(null)\nconst evaluator = ref(null)\nconst { brand } = sessionStore()\nconst courses = ref([])\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst router = useRouter()\n\nconst props = defineProps({\n\tcourseName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nonMounted(() => {\n\tfetchEnrollmentDetails()\n\tfetchCourseDetails()\n})\n\nconst certificate = createResource({\n\turl: 'frappe.client.get_value',\n\tparams: {\n\t\tdoctype: 'LMS Certificate',\n\t\tfilters: {\n\t\t\tmember: user.data?.name,\n\t\t\tcourse: props.courseName,\n\t\t},\n\t\tfieldname: ['name', 'template', 'issue_date'],\n\t},\n\tcache: [user.data?.name, props.courseName],\n})\n\nconst fetchEnrollmentDetails = () => {\n\tcall('frappe.client.get_value', {\n\t\tdoctype: 'LMS Enrollment',\n\t\tfilters: { member: user.data?.name, course: props.courseName },\n\t\tfieldname: ['purchased_certificate'],\n\t}).then((data) => {\n\t\tif (data.purchased_certificate) {\n\t\t\tcertificate.reload()\n\t\t} else {\n\t\t\trouter.push({\n\t\t\t\tname: 'CourseDetail',\n\t\t\t\tparams: { courseName: props.courseName },\n\t\t\t})\n\t\t}\n\t})\n}\n\nconst fetchCourseDetails = () => {\n\tcall('frappe.client.get_value', {\n\t\tdoctype: 'LMS Course',\n\t\tfilters: { name: props.courseName },\n\t\tfieldname: ['title', 'evaluator'],\n\t}).then((data) => {\n\t\tcourseTitle.value = data.title\n\t\tevaluator.value = data.evaluator\n\t\tpopulateCourses()\n\t})\n}\n\nconst populateCourses = () => {\n\tcourses.value = [\n\t\t{\n\t\t\tcourse: props.courseName,\n\t\t\ttitle: courseTitle.value,\n\t\t\tevaluator: evaluator.value,\n\t\t},\n\t]\n}\n\nconst openCertificate = (certificate) => {\n\twindow.open(\n\t\t`/api/method/frappe.utils.print_format.download_pdf?doctype=LMS+Certificate&name=${\n\t\t\tcertificate.name\n\t\t}&format=${encodeURIComponent(certificate.template)}`,\n\t\t'_blank'\n\t)\n}\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: __('Courses'),\n\t\troute: { name: 'Courses' },\n\t},\n\t{\n\t\tlabel: courseTitle.value,\n\t\troute: { name: 'CourseDetail', params: { courseName: props.courseName } },\n\t},\n\t{\n\t\tlabel: __('Certification'),\n\t},\n])\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: courseTitle.value,\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n"],"names":["courseTitle","ref","evaluator","brand","sessionStore","courses","user","inject","dayjs","router","useRouter","props","__props","onMounted","fetchEnrollmentDetails","fetchCourseDetails","certificate","createResource","call","data","populateCourses","openCertificate","breadcrumbs","computed","usePageMeta","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_hoisted_2","_createElementBlock","_hoisted_3","_hoisted_4","_toDisplayString","__","_hoisted_5","_cache","$event","_hoisted_6","_hoisted_7","_hoisted_8","_createBlock","UpcomingEvaluations"],"mappings":"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"}