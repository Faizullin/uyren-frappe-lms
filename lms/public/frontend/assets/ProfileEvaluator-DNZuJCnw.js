import{i as N,o as j,r as S,L as D,A as p,H as i,b as q,e as c,f as v,g as r,t as n,l,h as o,aw as I,k as C,bi as L,F as O,x as R,bx as y,q as m,bn as W,bj as Y,n as h,p as w,P as G,_ as U,by as H,aI as X}from"./index-BIerRe8o.js";import"@headlessui/vue";import"@vueuse/core";import"@tiptap/extension-code-block-lowlight";import"@tiptap/extension-placeholder";import"@tiptap/extension-table";import"@tiptap/extension-table-cell";import"@tiptap/extension-table-header";import"@tiptap/extension-table-row";import"@tiptap/extension-text-align";import"@tiptap/extension-text-style";import"@tiptap/extension-typography";import"@tiptap/vue-3";import"@tiptap/extension-mention";import"@tiptap/core";import"@tiptap/extension-code-block";import"@tiptap/extension-heading";import"@tiptap/suggestion";import"@tiptap/extension-link";const J={class:"mt-7 mb-20"},K={class:"mb-4 text-lg font-semibold text-ink-gray-9"},Q={key:0,class:"flex items-center space-x-2 text-sm text-ink-gray-7 bg-surface-gray-1 px-3 py-2 rounded-md w-full text-center"},Z={key:1},ee={class:"grid grid-cols-3 md:grid-cols-4 gap-4 text-sm text-ink-gray-7 mb-4"},ae={class:"grid grid-cols-3 md:grid-cols-4 gap-4 mb-4 group"},te={class:"grid grid-cols-3 md:grid-cols-4 gap-4 mb-4"},le={class:"my-10"},oe={class:"mb-4 text-lg font-semibold text-ink-gray-9"},se={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},re={class:"mb-4 text-lg font-semibold text-ink-gray-9"},ne={key:0,class:"flex items-center bg-surface-green-2 text-green-900 text-sm p-1 rounded-md mb-4 w-fit"},Ce={__name:"ProfileEvaluator",props:{profile:{type:Object,required:!0}},setup($){const E=N("$user"),T=window.read_only_mode,b=$;j(()=>{E.data?.name!==b.profile.data?.name&&(window.location.href=`/user/${b.profile.data?.username}`)});const g=S(0),_=S(null),f=S(null),s=D({day:"",start_time:"",end_time:""}),d=p({url:"lms.lms.api.get_evaluator_details",params:{evaluator:b.profile.data?.name},auto:!0,onSuccess(e){e.slots.unavailable_from&&(_.value=e.slots.unavailable_from),e.slots.unavailable_to&&(f.value=e.slots.unavailable_to)}}),P=p({url:"frappe.client.insert",makeParams(e){return{doc:{doctype:"Evaluator Schedule",parent:d.data?.slots.name,parentfield:"schedule",parenttype:"Course Evaluator",...s}}},onSuccess(){i.success(__("Slot added successfully")),d.reload(),g.value=0,s.day="",s.start_time="",s.end_time=""},onError(e){i.error(e.messages?.[0]||e)}}),M=p({url:"frappe.client.set_value",makeParams(e){return{doctype:"Evaluator Schedule",name:e.name,fieldname:e.field,value:e.value}},onSuccess(){i.success(__("Availability updated successfully"))},onError(e){i.error(e.messages?.[0]||e)}}),z=p({url:"frappe.client.delete",makeParams(e){return{doctype:"Evaluator Schedule",name:e.name}},onSuccess(){i.success(__("Slot deleted successfully")),d.reload()},onError(e){i.error(e.messages?.[0]||e)}}),x=p({url:"frappe.client.set_value",makeParams(e){return{doctype:"Course Evaluator",name:d.data?.slots.name,fieldname:e.field,value:e.value}},onSuccess(){i.success(__("Unavailability updated successfully"))},onError(e){i.error(e.messages?.[0]||e)}}),V=(e,t,a)=>{M.submit({name:e,field:t,value:a},{validate(){if(!a)return`Please enter a value for ${X(t)}`}})},k=()=>{!s.day||!s.start_time||!s.end_time||P.submit()},A=e=>{z.submit({name:e})},B=p({url:"frappe.integrations.doctype.google_calendar.google_calendar.authorize_access",makeParams(){return{g_calendar:d.data?.calendar,reauthorize:1}},onSuccess(e){window.open(e.url)}}),F=q(()=>[{label:"Monday",value:"Monday"},{label:"Tuesday",value:"Tuesday"},{label:"Wednesday",value:"Wednesday"},{label:"Thursday",value:"Thursday"},{label:"Friday",value:"Friday"},{label:"Saturday",value:"Saturday"},{label:"Sunday",value:"Sunday"}]);return(e,t)=>(v(),c("div",J,[r("h2",K,n(e.__("My availability")),1),l(T)?(v(),c("div",Q,[o(l(I),{class:"size-4 stroke-1.5"}),r("span",null,n(e.__("You cannot change the availability when the site is being updated.")),1)])):(v(),c("div",Z,[r("div",null,[r("div",ee,[r("div",null,n(e.__("Day")),1),r("div",null,n(e.__("Start Time")),1),r("div",null,n(e.__("End Time")),1)]),l(d).data?(v(!0),c(O,{key:0},R(l(d).data.slots.schedule,a=>(v(),c("div",ae,[o(l(m),{type:"select",options:F.value,modelValue:a.day,"onUpdate:modelValue":u=>a.day=u,onFocusout:y(u=>V(a.name,"day",a.day),["stop"])},null,8,["options","modelValue","onUpdate:modelValue","onFocusout"]),o(l(m),{type:"time",modelValue:a.start_time,"onUpdate:modelValue":u=>a.start_time=u,onFocusout:y(u=>V(a.name,"start_time",a.start_time),["stop"])},null,8,["modelValue","onUpdate:modelValue","onFocusout"]),o(l(m),{type:"time",modelValue:a.end_time,"onUpdate:modelValue":u=>a.end_time=u,onFocusout:y(u=>V(a.name,"end_time",a.end_time),["stop"])},null,8,["modelValue","onUpdate:modelValue","onFocusout"]),o(l(W),{onClick:u=>A(a.name),class:"w-6 h-auto stroke-1.5 text-red-900 rounded-md cursor-pointer p-1 bg-surface-red-2 hidden group-hover:block"},null,8,["onClick"])]))),256)):C("",!0),L(r("div",te,[o(l(m),{type:"select",options:F.value,modelValue:s.day,"onUpdate:modelValue":t[0]||(t[0]=a=>s.day=a),onFocusout:t[1]||(t[1]=y(a=>k(),["stop"]))},null,8,["options","modelValue"]),o(l(m),{type:"time",modelValue:s.start_time,"onUpdate:modelValue":t[2]||(t[2]=a=>s.start_time=a),onFocusout:t[3]||(t[3]=y(a=>k(),["stop"]))},null,8,["modelValue"]),o(l(m),{type:"time",modelValue:s.end_time,"onUpdate:modelValue":t[4]||(t[4]=a=>s.end_time=a),onFocusout:t[5]||(t[5]=y(a=>k(),["stop"]))},null,8,["modelValue"])],512),[[Y,g.value]]),o(l(U),{onClick:t[6]||(t[6]=a=>g.value=1)},{prefix:h(()=>[o(l(G),{class:"w-4 h-4 stroke-1.5 text-ink-gray-7"})]),default:h(()=>[w(" "+n(e.__("Add Slot")),1)]),_:1})]),r("div",le,[r("h2",oe,n(e.__("I am unavailable")),1),r("div",se,[o(l(m),{type:"date",label:e.__("From"),modelValue:_.value,"onUpdate:modelValue":t[7]||(t[7]=a=>_.value=a),onBlur:t[8]||(t[8]=()=>{l(x).submit({field:"unavailable_from",value:_.value})})},null,8,["label","modelValue"]),o(l(m),{type:"date",label:e.__("To"),modelValue:f.value,"onUpdate:modelValue":t[9]||(t[9]=a=>f.value=a),onBlur:t[10]||(t[10]=()=>{l(x).submit({field:"unavailable_to",value:f.value})})},null,8,["label","modelValue"])])]),r("div",null,[r("h2",re,n(e.__("My calendar")),1),l(d).data?.calendar&&l(d).data?.is_authorized?(v(),c("div",ne,[o(l(H),{class:"h-4 w-4 stroke-1.5 mr-2"}),w(" "+n(e.__("Your calendar is set.")),1)])):C("",!0),o(l(U),{onClick:t[11]||(t[11]=()=>l(B).submit())},{default:h(()=>[w(n(e.__("Authorize Google Calendar Access")),1)]),_:1})])]))]))}};export{Ce as default};
//# sourceMappingURL=ProfileEvaluator-DNZuJCnw.js.map
